<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ES-es" xml:lang="ES-es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fuentes-Sáenz, Luis - Uribe-Lache, Julian - Sánchez-Charris, Vanessa">
<meta name="description" content="Se realizarán algunos ejercicios con el objetivo de fortalecer destrezas en manejo y análisis de bases de datos.">

<title>Visualización y análisis multivariado de comunidades ícticas en un sistema fluvial: ejercicio exploratorio basado en los datos de Ruiz-Campos et al.&nbsp;(2021)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="estudio de caso_files/libs/clipboard/clipboard.min.js"></script>
<script src="estudio de caso_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="estudio de caso_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="estudio de caso_files/libs/quarto-html/popper.min.js"></script>
<script src="estudio de caso_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="estudio de caso_files/libs/quarto-html/anchor.min.js"></script>
<link href="estudio de caso_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="estudio de caso_files/libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="estudio de caso_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="estudio de caso_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="estudio de caso_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<style>

      .quarto-title-block .quarto-title-banner {
        background: #2ca25f;
      }
</style>
<script src="estudio de caso_files/libs/kePrint-0.0.1/kePrint.js"></script>

<link href="estudio de caso_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">



<link rel="stylesheet" href="styles2.css">
</head>

<body class="quarto-light">

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Visualización y análisis multivariado de comunidades ícticas en un sistema fluvial: ejercicio exploratorio basado en los datos de Ruiz-Campos et al.&nbsp;(2021)</h1>
            <p class="subtitle lead">Estudio de caso para la aplicación de estadíastica multivariada</p>
                  <div>
        <div class="description">
          Se realizarán algunos ejercicios con el objetivo de fortalecer destrezas en manejo y análisis de bases de datos.
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Autor/a</div>
      <div class="quarto-title-meta-contents">
               <p><a href="https://www.unimagdalena.edu.co/">Fuentes-Sáenz, Luis - Uribe-Lache, Julian - Sánchez-Charris, Vanessa</a> </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Fecha de publicación</div>
      <div class="quarto-title-meta-contents">
        <p class="date">21 de mayo de 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Menú flotante</h2>
   
  <ul>
  <li><a href="#contexto-de-la-base-de-datos" id="toc-contexto-de-la-base-de-datos" class="nav-link active" data-scroll-target="#contexto-de-la-base-de-datos">Contexto de la base de datos</a></li>
  <li><a href="#introducción" id="toc-introducción" class="nav-link" data-scroll-target="#introducción">Introducción</a></li>
  <li><a href="#objetivos" id="toc-objetivos" class="nav-link" data-scroll-target="#objetivos">Objetivos</a>
  <ul>
  <li><a href="#objetivo-general" id="toc-objetivo-general" class="nav-link" data-scroll-target="#objetivo-general">Objetivo General:</a></li>
  <li><a href="#objetivos-específicos" id="toc-objetivos-específicos" class="nav-link" data-scroll-target="#objetivos-específicos">Objetivos Específicos:</a></li>
  </ul></li>
  <li><a href="#pregunta-de-análisis" id="toc-pregunta-de-análisis" class="nav-link" data-scroll-target="#pregunta-de-análisis"><strong>Pregunta de análisis:</strong></a></li>
  <li><a href="#diagrama-de-flujo" id="toc-diagrama-de-flujo" class="nav-link" data-scroll-target="#diagrama-de-flujo">Diagrama de flujo</a></li>
  <li><a href="#librerías-requeridas" id="toc-librerías-requeridas" class="nav-link" data-scroll-target="#librerías-requeridas">Librerías requeridas</a></li>
  <li><a href="#base-de-datos" id="toc-base-de-datos" class="nav-link" data-scroll-target="#base-de-datos">Base de datos</a></li>
  <li><a href="#abundancia-por-sitios" id="toc-abundancia-por-sitios" class="nav-link" data-scroll-target="#abundancia-por-sitios">Abundancia por sitios</a></li>
  <li><a href="#taxones-más-abundantes" id="toc-taxones-más-abundantes" class="nav-link" data-scroll-target="#taxones-más-abundantes">Taxones más abundantes</a></li>
  <li><a href="#resumen-estadístico-de-la-base-de-datos-biológica" id="toc-resumen-estadístico-de-la-base-de-datos-biológica" class="nav-link" data-scroll-target="#resumen-estadístico-de-la-base-de-datos-biológica">Resumen estadístico de la base de datos biológica</a></li>
  <li><a href="#resumen-estadístico-de-la-base-de-datos-ambiental" id="toc-resumen-estadístico-de-la-base-de-datos-ambiental" class="nav-link" data-scroll-target="#resumen-estadístico-de-la-base-de-datos-ambiental">Resumen estadístico de la base de datos ambiental</a></li>
  <li><a href="#exploración-gráfica-en-excel" id="toc-exploración-gráfica-en-excel" class="nav-link" data-scroll-target="#exploración-gráfica-en-excel">Exploración gráfica en Excel</a></li>
  <li><a href="#exploración-gráfica" id="toc-exploración-gráfica" class="nav-link" data-scroll-target="#exploración-gráfica">Exploración gráfica</a>
  <ul>
  <li><a href="#figura-de-elipises-con-las-especies-más-abundantes" id="toc-figura-de-elipises-con-las-especies-más-abundantes" class="nav-link" data-scroll-target="#figura-de-elipises-con-las-especies-más-abundantes">Figura de elipises con las especies más abundantes</a></li>
  <li><a href="#figura-de-elipses-de-los-datos-ambientales-fisicoquímicos" id="toc-figura-de-elipses-de-los-datos-ambientales-fisicoquímicos" class="nav-link" data-scroll-target="#figura-de-elipses-de-los-datos-ambientales-fisicoquímicos">Figura de elipses de los datos ambientales fisicoquímicos</a></li>
  <li><a href="#figura-de-elipses-de-los-datos-ambientales-y-biológicos-con-las-abundancias-convertidas-a-logaritmo-log10" id="toc-figura-de-elipses-de-los-datos-ambientales-y-biológicos-con-las-abundancias-convertidas-a-logaritmo-log10" class="nav-link" data-scroll-target="#figura-de-elipses-de-los-datos-ambientales-y-biológicos-con-las-abundancias-convertidas-a-logaritmo-log10">Figura de elipses de los datos ambientales y biológicos con las abundancias convertidas a logaritmo (<code>log10</code>)</a></li>
  <li><a href="#nueva-columna-con-los-ríos-a-los-que-pertenece-cada-sitio-muestreado" id="toc-nueva-columna-con-los-ríos-a-los-que-pertenece-cada-sitio-muestreado" class="nav-link" data-scroll-target="#nueva-columna-con-los-ríos-a-los-que-pertenece-cada-sitio-muestreado">Nueva columna con los ríos a los que pertenece cada sitio muestreado</a></li>
  <li><a href="#figuras-de-cajas-y-bigotes" id="toc-figuras-de-cajas-y-bigotes" class="nav-link" data-scroll-target="#figuras-de-cajas-y-bigotes">Figuras de cajas y bigotes</a></li>
  <li><a href="#figuras-multivaraidas-de-cajas-y-bigotes" id="toc-figuras-multivaraidas-de-cajas-y-bigotes" class="nav-link" data-scroll-target="#figuras-multivaraidas-de-cajas-y-bigotes">Figuras multivaraidas de Cajas y bigotes</a></li>
  <li><a href="#regresión-lineal-entre-la-abundancia-y-la-altitud" id="toc-regresión-lineal-entre-la-abundancia-y-la-altitud" class="nav-link" data-scroll-target="#regresión-lineal-entre-la-abundancia-y-la-altitud">Regresión lineal entre la abundancia y la Altitud</a></li>
  <li><a href="#regresión-suavizada-entre-la-abundancia-y-la-altitud" id="toc-regresión-suavizada-entre-la-abundancia-y-la-altitud" class="nav-link" data-scroll-target="#regresión-suavizada-entre-la-abundancia-y-la-altitud">Regresión suavizada entre la abundancia y la Altitud</a></li>
  <li><a href="#regresión-lineal-entre-la-abundancia-y-los-sólidos-disueltos-totales-tds" id="toc-regresión-lineal-entre-la-abundancia-y-los-sólidos-disueltos-totales-tds" class="nav-link" data-scroll-target="#regresión-lineal-entre-la-abundancia-y-los-sólidos-disueltos-totales-tds">Regresión lineal entre la abundancia y los Sólidos Disueltos Totales (TDS)</a></li>
  <li><a href="#regresión-suavizada-entre-la-abundancia-y-los-sólidos-disueltos-totales" id="toc-regresión-suavizada-entre-la-abundancia-y-los-sólidos-disueltos-totales" class="nav-link" data-scroll-target="#regresión-suavizada-entre-la-abundancia-y-los-sólidos-disueltos-totales">Regresión suavizada entre la abundancia y los Sólidos Disueltos Totales</a></li>
  <li><a href="#grafico-de-burbujas" id="toc-grafico-de-burbujas" class="nav-link" data-scroll-target="#grafico-de-burbujas">Grafico de burbujas</a></li>
  </ul></li>
  <li><a href="#pca" id="toc-pca" class="nav-link" data-scroll-target="#pca">PCA</a>
  <ul>
  <li><a href="#ajuste-de-las-bases-de-datos-fisiqcoquimica-amb-y-biológica-tax.hel" id="toc-ajuste-de-las-bases-de-datos-fisiqcoquimica-amb-y-biológica-tax.hel" class="nav-link" data-scroll-target="#ajuste-de-las-bases-de-datos-fisiqcoquimica-amb-y-biológica-tax.hel">1. Ajuste de las bases de datos fisiqcoquimica (amb) y biológica (tax.hel)</a></li>
  <li><a href="#pca-con-paquete-factoextra" id="toc-pca-con-paquete-factoextra" class="nav-link" data-scroll-target="#pca-con-paquete-factoextra"><strong>2. PCA con paquete factoextra</strong></a>
  <ul>
  <li><a href="#contribución-eje-1" id="toc-contribución-eje-1" class="nav-link" data-scroll-target="#contribución-eje-1"><strong>2.1. Contribución eje 1</strong></a></li>
  </ul></li>
  <li><a href="#pca-con-ggplot" id="toc-pca-con-ggplot" class="nav-link" data-scroll-target="#pca-con-ggplot">3. PCA con ggplot</a>
  <ul>
  <li><a href="#coordenadas-de-los-sitios-y-el-factor-coord.sit" id="toc-coordenadas-de-los-sitios-y-el-factor-coord.sit" class="nav-link" data-scroll-target="#coordenadas-de-los-sitios-y-el-factor-coord.sit"><strong>3.1. Coordenadas de los sitios y el factor “coord.sit</strong></a></li>
  <li><a href="#coordenadas-de-los-taxones-coord.tax" id="toc-coordenadas-de-los-taxones-coord.tax" class="nav-link" data-scroll-target="#coordenadas-de-los-taxones-coord.tax"><strong>3.2. Coordenadas de los taxones “coord.tax”</strong></a></li>
  <li><a href="#coordenadas-de-las-ambientales-coord.amb" id="toc-coordenadas-de-las-ambientales-coord.amb" class="nav-link" data-scroll-target="#coordenadas-de-las-ambientales-coord.amb"><strong>3.3. Coordenadas de las ambientales “coord.amb”</strong></a></li>
  <li><a href="#figura-con-de-elipses-por-concavidades---geom_mark_hull" id="toc-figura-con-de-elipses-por-concavidades---geom_mark_hull" class="nav-link" data-scroll-target="#figura-con-de-elipses-por-concavidades---geom_mark_hull"><strong>3.4. Figura con de elipses por concavidades - geom_mark_hull</strong></a></li>
  <li><a href="#figura-con-de-elipses-por-cada-zona" id="toc-figura-con-de-elipses-por-cada-zona" class="nav-link" data-scroll-target="#figura-con-de-elipses-por-cada-zona"><strong>3.5. Figura con de elipses por cada zona</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#nmds" id="toc-nmds" class="nav-link" data-scroll-target="#nmds">NMDS</a>
  <ul>
  <li><a href="#ordenación-con-nmds---paquete-vegan" id="toc-ordenación-con-nmds---paquete-vegan" class="nav-link" data-scroll-target="#ordenación-con-nmds---paquete-vegan"><strong>1. Ordenación con NMDS - paquete vegan</strong></a>
  <ul>
  <li><a href="#paso-1.-correr-el-nmds-y-analizar-la-disitancia-usada-y-el-estrés" id="toc-paso-1.-correr-el-nmds-y-analizar-la-disitancia-usada-y-el-estrés" class="nav-link" data-scroll-target="#paso-1.-correr-el-nmds-y-analizar-la-disitancia-usada-y-el-estrés"><strong>Paso 1. Correr el NMDS y analizar la disitancia usada y el estrés</strong></a></li>
  <li><a href="#paso-2.-figuras-del-nmds-con-el-paquete-vegan" id="toc-paso-2.-figuras-del-nmds-con-el-paquete-vegan" class="nav-link" data-scroll-target="#paso-2.-figuras-del-nmds-con-el-paquete-vegan"><strong>Paso 2. Figuras del nmds con el paquete “vegan”</strong></a></li>
  <li><a href="#figura-del-nmds-con-el-comando-orditorp" id="toc-figura-del-nmds-con-el-comando-orditorp" class="nav-link" data-scroll-target="#figura-del-nmds-con-el-comando-orditorp"><strong>Figura del NMDS con el comando <em>orditorp</em></strong></a></li>
  <li><a href="#figura-del-nmds-con-variables-ambientales" id="toc-figura-del-nmds-con-variables-ambientales" class="nav-link" data-scroll-target="#figura-del-nmds-con-variables-ambientales"><strong>Figura del NMDS con variables ambientales</strong></a></li>
  </ul></li>
  <li><a href="#generación-de-factores-variables-agrupadoras" id="toc-generación-de-factores-variables-agrupadoras" class="nav-link" data-scroll-target="#generación-de-factores-variables-agrupadoras"><strong>Generación de factores (variables agrupadoras)</strong></a></li>
  <li><a href="#ordenación-nmds-con-ggplot2" id="toc-ordenación-nmds-con-ggplot2" class="nav-link" data-scroll-target="#ordenación-nmds-con-ggplot2"><strong>2. Ordenación NMDS con ggplot2</strong></a>
  <ul>
  <li><a href="#coordenadas-de-los-sitios-y-el-factor-coord.sit-1" id="toc-coordenadas-de-los-sitios-y-el-factor-coord.sit-1" class="nav-link" data-scroll-target="#coordenadas-de-los-sitios-y-el-factor-coord.sit-1"><strong>2.1 Coordenadas de los sitios y el factor “coord.sit”</strong></a></li>
  <li><a href="#coordenadas-de-las-especies-coord.esp" id="toc-coordenadas-de-las-especies-coord.esp" class="nav-link" data-scroll-target="#coordenadas-de-las-especies-coord.esp"><strong>2.2 Coordenadas de las especies “coord.esp”</strong></a></li>
  <li><a href="#coordenadas-de-las-ambientales-coord.amb-1" id="toc-coordenadas-de-las-ambientales-coord.amb-1" class="nav-link" data-scroll-target="#coordenadas-de-las-ambientales-coord.amb-1"><strong>2.3 Coordenadas de las ambientales “coord.amb”</strong></a></li>
  <li><a href="#figura-de-elipses-por-concavidades---geom_mark_elipse" id="toc-figura-de-elipses-por-concavidades---geom_mark_elipse" class="nav-link" data-scroll-target="#figura-de-elipses-por-concavidades---geom_mark_elipse"><strong>2.4 Figura de elipses por concavidades - geom_mark_elipse</strong></a></li>
  <li><a href="#figura-con-vectores-de-especies-y-variables-ambientales" id="toc-figura-con-vectores-de-especies-y-variables-ambientales" class="nav-link" data-scroll-target="#figura-con-vectores-de-especies-y-variables-ambientales"><strong>2.5 Figura con vectores de especies y variables ambientales</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#análisis-de-clúster-cla" id="toc-análisis-de-clúster-cla" class="nav-link" data-scroll-target="#análisis-de-clúster-cla">Análisis de clúster (cla)</a>
  <ul>
  <li><a href="#análisis-de-clúster-con-datos-ambientales" id="toc-análisis-de-clúster-con-datos-ambientales" class="nav-link" data-scroll-target="#análisis-de-clúster-con-datos-ambientales"><strong>Análisis de Clúster con datos ambientales</strong></a></li>
  <li><a href="#cargar-la-base-de-datos" id="toc-cargar-la-base-de-datos" class="nav-link" data-scroll-target="#cargar-la-base-de-datos">Cargar la base de datos</a>
  <ul>
  <li><a href="#paso-1.-distancia-entre-observaciones" id="toc-paso-1.-distancia-entre-observaciones" class="nav-link" data-scroll-target="#paso-1.-distancia-entre-observaciones"><strong>Paso 1. Distancia entre observaciones</strong></a></li>
  <li><a href="#paso-2.-elección-del-mejor-método-de-agrupación" id="toc-paso-2.-elección-del-mejor-método-de-agrupación" class="nav-link" data-scroll-target="#paso-2.-elección-del-mejor-método-de-agrupación"><strong>Paso 2. Elección del mejor método de agrupación</strong></a>
  <ul>
  <li><a href="#siete-métodos-de-agrupamiento" id="toc-siete-métodos-de-agrupamiento" class="nav-link" data-scroll-target="#siete-métodos-de-agrupamiento"><strong>2.1 Siete métodos de agrupamiento</strong></a></li>
  <li><a href="#graficar-los-7-dendogramas" id="toc-graficar-los-7-dendogramas" class="nav-link" data-scroll-target="#graficar-los-7-dendogramas"><strong>2.2 Graficar los 7 dendogramas</strong></a></li>
  <li><a href="#correlación-cofenetica" id="toc-correlación-cofenetica" class="nav-link" data-scroll-target="#correlación-cofenetica">2.3. Correlación cofenetica</a></li>
  </ul></li>
  <li><a href="#paso-3.-número-de-grupos-formados" id="toc-paso-3.-número-de-grupos-formados" class="nav-link" data-scroll-target="#paso-3.-número-de-grupos-formados"><strong>Paso 3. Número de grupos formados</strong></a>
  <ul>
  <li><a href="#opción-1.-niveles-de-fusión" id="toc-opción-1.-niveles-de-fusión" class="nav-link" data-scroll-target="#opción-1.-niveles-de-fusión"><strong>Opción 1. Niveles de Fusión</strong></a></li>
  <li><a href="#opción-2.-amplitud-de-silueta-3-insumos-requeridos" id="toc-opción-2.-amplitud-de-silueta-3-insumos-requeridos" class="nav-link" data-scroll-target="#opción-2.-amplitud-de-silueta-3-insumos-requeridos"><strong>Opción 2. Amplitud de silueta (3 insumos requeridos)</strong></a></li>
  </ul></li>
  <li><a href="#figura-del-dendograma-jerárquico-final" id="toc-figura-del-dendograma-jerárquico-final" class="nav-link" data-scroll-target="#figura-del-dendograma-jerárquico-final"><strong>Figura del dendograma jerárquico final</strong></a></li>
  </ul></li>
  <li><a href="#análisis-de-clúster-con-datos-biológicos" id="toc-análisis-de-clúster-con-datos-biológicos" class="nav-link" data-scroll-target="#análisis-de-clúster-con-datos-biológicos"><strong>Análisis de Clúster con datos biológicos</strong></a></li>
  <li><a href="#cargar-base-de-datos" id="toc-cargar-base-de-datos" class="nav-link" data-scroll-target="#cargar-base-de-datos">Cargar base de datos</a>
  <ul>
  <li><a href="#paso-1.-distancia-entre-observaciones-1" id="toc-paso-1.-distancia-entre-observaciones-1" class="nav-link" data-scroll-target="#paso-1.-distancia-entre-observaciones-1"><strong>Paso 1. Distancia entre observaciones</strong></a></li>
  <li><a href="#paso-2.-elección-del-mejor-método-de-agrupación-1" id="toc-paso-2.-elección-del-mejor-método-de-agrupación-1" class="nav-link" data-scroll-target="#paso-2.-elección-del-mejor-método-de-agrupación-1"><strong>Paso 2. Elección del mejor método de agrupación</strong></a>
  <ul>
  <li><a href="#siete-métodos-de-agrupamiento-1" id="toc-siete-métodos-de-agrupamiento-1" class="nav-link" data-scroll-target="#siete-métodos-de-agrupamiento-1"><strong>2.1 Siete métodos de agrupamiento</strong></a></li>
  <li><a href="#graficar-los-7-dendogramas-1" id="toc-graficar-los-7-dendogramas-1" class="nav-link" data-scroll-target="#graficar-los-7-dendogramas-1"><strong>2.2 Graficar los 7 dendogramas</strong></a></li>
  <li><a href="#correlación-cofenética" id="toc-correlación-cofenética" class="nav-link" data-scroll-target="#correlación-cofenética"><strong>2.3 Correlación cofenética</strong></a></li>
  </ul></li>
  <li><a href="#paso-3.-número-de-grupos-formados-1" id="toc-paso-3.-número-de-grupos-formados-1" class="nav-link" data-scroll-target="#paso-3.-número-de-grupos-formados-1"><strong>Paso 3. Número de grupos formados</strong></a>
  <ul>
  <li><a href="#opción-1.-niveles-de-fusión-1" id="toc-opción-1.-niveles-de-fusión-1" class="nav-link" data-scroll-target="#opción-1.-niveles-de-fusión-1"><strong>Opción 1. Niveles de Fusión</strong></a></li>
  <li><a href="#opción-2.-amplitud-de-silueta-3-insumos-requeridos-1" id="toc-opción-2.-amplitud-de-silueta-3-insumos-requeridos-1" class="nav-link" data-scroll-target="#opción-2.-amplitud-de-silueta-3-insumos-requeridos-1"><strong>Opción 2. Amplitud de silueta (3 insumos requeridos)</strong></a></li>
  </ul></li>
  <li><a href="#figura-del-dendograma-jerárquico-final-1" id="toc-figura-del-dendograma-jerárquico-final-1" class="nav-link" data-scroll-target="#figura-del-dendograma-jerárquico-final-1"><strong>Figura del dendograma jerárquico final</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#análisis-discriminante-lineal-lda" id="toc-análisis-discriminante-lineal-lda" class="nav-link" data-scroll-target="#análisis-discriminante-lineal-lda">Análisis discriminante lineal (lda)</a>
  <ul>
  <li><a href="#paso-1.-prueba-de-supuestos" id="toc-paso-1.-prueba-de-supuestos" class="nav-link" data-scroll-target="#paso-1.-prueba-de-supuestos">Paso 1. Prueba de supuestos</a>
  <ul>
  <li><a href="#supuesto-normalidad" id="toc-supuesto-normalidad" class="nav-link" data-scroll-target="#supuesto-normalidad">1.1. Supuesto Normalidad</a></li>
  <li><a href="#supuesto-de-homogeneidad-de-covarianzas" id="toc-supuesto-de-homogeneidad-de-covarianzas" class="nav-link" data-scroll-target="#supuesto-de-homogeneidad-de-covarianzas"><strong>1.2 Supuesto de homogeneidad de covarianzas</strong></a></li>
  </ul></li>
  <li><a href="#paso-2.-análisis-discriminante-lineal-de-fisher" id="toc-paso-2.-análisis-discriminante-lineal-de-fisher" class="nav-link" data-scroll-target="#paso-2.-análisis-discriminante-lineal-de-fisher"><strong>Paso 2. Análisis discriminante lineal de Fisher</strong></a></li>
  <li><a href="#paso-3.-visualización-grafica-del-lda" id="toc-paso-3.-visualización-grafica-del-lda" class="nav-link" data-scroll-target="#paso-3.-visualización-grafica-del-lda"><strong>Paso 3. Visualización grafica del LDA</strong></a>
  <ul>
  <li><a href="#figura-con-vectores-de-variables-biológicas" id="toc-figura-con-vectores-de-variables-biológicas" class="nav-link" data-scroll-target="#figura-con-vectores-de-variables-biológicas">Figura con vectores de variables biológicas</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#análisis-discriminante-canónico-dca" id="toc-análisis-discriminante-canónico-dca" class="nav-link" data-scroll-target="#análisis-discriminante-canónico-dca">Análisis discriminante canónico (dca)</a></li>
  <li><a href="#referencias-bibliográficas" id="toc-referencias-bibliográficas" class="nav-link" data-scroll-target="#referencias-bibliográficas">Referencias bibliográficas</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<hr>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/foto%20artículo.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>DOI: <a href="https://doi.org/10.1007/s10641-021-01158-9" class="uri">https://doi.org/10.1007/s10641-021-01158-9</a></p>
<hr>
<section id="contexto-de-la-base-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="contexto-de-la-base-de-datos">Contexto de la base de datos</h2>
<p>Las bases de datos están compuestas por dos archivos de Excel que contienen datos biológicos y ambientales. En la base de datos biológicos, se encuentran columnas de 90 especies y en las filas las localidades, estas están identificadas con las iniciales M (montaña), P (llanura) y RM (desembocadura de río), indicando la altitud de cada sitio, y están numeradas del 1 al 43. La base de datos ambientales esta constituida por 23 variables ambientales de las cuales 7 variables son cuantitativas y 16 cualitativas. Además, se midieron 9 parámetros de calidad de agua en cada sitio.</p>
<hr>
</section>
<section id="introducción" class="level2">
<h2 class="anchored" data-anchor-id="introducción">Introducción</h2>
<p>La comprensión de los patrones de diversidad y distribución de las comunidades acuáticas es fundamental al abordar los sistemas fluviales, porque son determinantes para la ecología acuática contemporánea. Estos patrones han reflejado la interacción entre factores bióticos y abióticos, así como han servido como indicadores de la salud ecosistémica de integridad hidrológica (Ospina et al., 2023). Los peces son uno de los grupos más diversos y ecológicamente significativos de la fauna que habita el ecosistema. La variación longitudinal crea, de hecho, gradientes ambientales que modelan la estructura de las comunidades de peces, tanto en los sistemas neotropicales como en los templados (Ospina et al., 2023; Torruco et al., 2017). Sin embargo, la incertidumbre de los controladores de estos sistemas con relación a la dimensionalidad de las variables ambientales y biológicas sólo puede abordarse a partir de un análisis capaz de juntar disímiles informaciones en patrones ecológicos significativos. Es por esta razón que se emplea la estadística multivariada.</p>
<p>Como buena parte de la ciencia moderna, la ecología ha evolucionado de enfoques más sencillos hacia el uso de modelos estadísticos multivariantes. En este caso, la multi-variedad proporciona a los ecólogos la posibilidad de responder a preguntas complejas sobre la estratificación de la comunidad (De Catalunya et al., 2018). La evolución posterior, en el contexto del software estadístico en general y del lenguaje R en particular, ha permitido que un número cada vez mayor de ecólogos formule y analice hipótesis complejas y multivariantes dentro de flujos de trabajo reproducibles y personalizados (González, 2017).</p>
<p>En el presente ejercicio, se empleará una base de datos derivada del estudio de Ruiz-Campos et al.&nbsp;(2021), donde se analiza la diversidad y distribución longitudinal de las comunidades de peces en la cuenca del río Soto La Marina, al noreste de México. A través del análisis de datos ambientales y biológicos recolectados en 43 sitios, los autores identifican tres ensamblajes principales asociados a zonas fisiográficas (montaña, planicie y desembocadura), y exploran cómo variables como salinidad, conductividad, turbidez y estructura del hábitat explican la composición de la ictiofauna a lo largo del gradiente ambiental. Se realizará un proceso básico de preparación de datos, seguido de visualizaciones exploratorias, a su vez como parte del enfoque multivariado, se implementarán análisis de Componentes Principales (PCA) para explorar gradientes ambientales y Escalamiento Multidimensional No Métrico (NMDS) para evaluar la estructuración de las comunidades ícticas en función de la composición de especies. Todos los análisis serán desarrollados mediante el software estadístico RStudio. Con ello, se busca identificar tendencias espaciales, relaciones entre variables y patrones ecológicos relevantes en la diversidad de peces a lo largo del gradiente longitudinal del sistema fluvial.</p>
<hr>
</section>
<section id="objetivos" class="level2">
<h2 class="anchored" data-anchor-id="objetivos">Objetivos</h2>
<section id="objetivo-general" class="level3">
<h3 class="anchored" data-anchor-id="objetivo-general">Objetivo General:</h3>
<p>Examinar los patrones de distribución de las comunidades de peces en un sistema fluvial a partir de sus relaciones con gradientes ambientales, mediante el uso de técnicas de análisis&nbsp;multivariado.</p>
</section>
<section id="objetivos-específicos" class="level3">
<h3 class="anchored" data-anchor-id="objetivos-específicos">Objetivos Específicos:</h3>
<ol type="1">
<li>Estimar la asociación entre variables ambientales y la composición de especies de peces mediante modelos multivariados.</li>
<li>Detectar patrones de agrupamiento entre sitios de muestreo en función de similitudes en las comunidades ícticas.</li>
<li>Comparar técnicas de ordenación para evaluar su eficacia en la representación de la estructura ecológica y los gradientes ambientales&nbsp;asociados.</li>
</ol>
<hr>
</section>
</section>
<section id="pregunta-de-análisis" class="level2">
<h2 class="anchored" data-anchor-id="pregunta-de-análisis"><strong>Pregunta de análisis:</strong></h2>
<p>¿Qué variables ambientales están más relacionadas con los cambios en las comunidades de peces a lo largo del sistema fluvial, y cómo estas relaciones pueden explicar los patrones de distribución&nbsp;observados?</p>
<hr>
</section>
<section id="diagrama-de-flujo" class="level2">
<h2 class="anchored" data-anchor-id="diagrama-de-flujo">Diagrama de flujo</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/Diagrama%20de%20flujo.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<hr>
</section>
<section id="librerías-requeridas" class="level2">
<h2 class="anchored" data-anchor-id="librerías-requeridas">Librerías requeridas</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ellipse)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(SciViews)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)       </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally) </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(gclus)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(SciViews)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(ade4)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(vegan)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(stats) </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"gplots"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(factoextra)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggforce)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(candisc)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"funciones.r"</span>)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="base-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="base-de-datos">Base de datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leer la base de datos</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"peces marinos méxico_biológicos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Hoja1"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>amb <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"peces marinos méxico_ambientales.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Hoja1"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir de formato largo a ancho los datos biológicos</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>largo_biol <span class="ot">&lt;-</span> biol <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">90</span>,  <span class="co"># Seleccionamos las columnas de especies</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Especie"</span>,  <span class="co"># Nueva columna con los nombres de las especies</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Abundancia"</span>)  <span class="co"># Nueva columna con los valores de abundancia</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convertir de formato largo a ancho los datos ambientales</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>largo_amb <span class="ot">&lt;-</span> amb <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">38</span>,  <span class="co"># Seleccionamos las columnas de especies</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Variables"</span>,  <span class="co"># Nueva columna con los nombres de las especies</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"Valores"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="abundancia-por-sitios" class="level2">
<h2 class="anchored" data-anchor-id="abundancia-por-sitios">Abundancia por sitios</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>largo_biol <span class="ot">&lt;-</span> largo_biol <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sitios) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Abundancia_Total_Sitio =</span> <span class="fu">sum</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen de la base de datos original (seis primeras filas)</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(largo_biol) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Sitios</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Especie</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Abundancia</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Abundancia_Total_Sitio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">17M</td>
<td style="text-align: left;">Hypanus sabinus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">95</td>
</tr>
<tr class="even">
<td style="text-align: left;">17M</td>
<td style="text-align: left;">Atractosteus spatula</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">95</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17M</td>
<td style="text-align: left;">Elops saurus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">95</td>
</tr>
<tr class="even">
<td style="text-align: left;">17M</td>
<td style="text-align: left;">Megalops atlanticus</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">95</td>
</tr>
<tr class="odd">
<td style="text-align: left;">17M</td>
<td style="text-align: left;">Albula vulpes</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">95</td>
</tr>
<tr class="even">
<td style="text-align: left;">17M</td>
<td style="text-align: left;">Anguila rostrata</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">95</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generar una nueva columna con valores abreviados en biol</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>largo_biol <span class="ot">&lt;-</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  largo_biol <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Abrev =</span> <span class="fu">abbreviate</span>(Especie, <span class="at">minlength =</span> <span class="dv">4</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unir bases de datos</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>biol_amb <span class="ot">&lt;-</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  amb <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(largo_biol, <span class="at">by=</span> <span class="st">"Sitios"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="taxones-más-abundantes" class="level2">
<h2 class="anchored" data-anchor-id="taxones-más-abundantes">Taxones más abundantes</h2>
<p>La <a href="#tbl-tbl1" class="quarto-xref">Tabla&nbsp;1</a> muestra las 30 especies más abundantes en los diferentes ríos muestreados. Se observa que la especie <em>Poecilia mexicana</em> es la más abundante con un total de 5.573 registros, seguida de la especie <em>Astyanax mexicanus</em> con 4.003 registros, indicando que son especies muy comunes en los sitios de estudio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seleccionar los 15 taxones más abundantes</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  Abundantes <span class="ot">&lt;-</span> largo_biol <span class="sc">%&gt;%</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Especie, Abrev) <span class="sc">%&gt;%</span>  <span class="co"># Agrupar por especie y abreviatura</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Abundancia_Total =</span> <span class="fu">sum</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span>  <span class="co"># Eliminar el agrupamiento</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Abundancia_Total)) <span class="sc">%&gt;%</span>  <span class="co"># Ordenar de mayor a menor</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">30</span>)  <span class="co"># Seleccionar los 15 taxones más abundantes</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualizar tabla</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (Abundantes) <span class="sc">%&gt;%</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl1" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;1: Abundancia de Especies de Peces (30 más abundantes) en la cuenca del río Soto La Marina, México (seis primeras filas).
</figcaption>
<div aria-describedby="tbl-tbl1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Especie</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Abrev</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Abundancia_Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Poecilia mexicana</td>
<td style="text-align: left;">Pclm</td>
<td style="text-align: right;">5573</td>
</tr>
<tr class="even">
<td style="text-align: left;">Astyanax mexicanus</td>
<td style="text-align: left;">Astm</td>
<td style="text-align: right;">4003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Herichthys cyanoguttatus</td>
<td style="text-align: left;">Hrcc</td>
<td style="text-align: right;">1616</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gambusia regani</td>
<td style="text-align: left;">Gmbr</td>
<td style="text-align: right;">1519</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Poecilia formosa</td>
<td style="text-align: left;">Pclf</td>
<td style="text-align: right;">1222</td>
</tr>
<tr class="even">
<td style="text-align: left;">Notropis aguirrepequeñoi</td>
<td style="text-align: left;">Nagñ</td>
<td style="text-align: right;">996</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="resumen-estadístico-de-la-base-de-datos-biológica" class="level2">
<h2 class="anchored" data-anchor-id="resumen-estadístico-de-la-base-de-datos-biológica">Resumen estadístico de la base de datos biológica</h2>
<p>La <a href="#tbl-tbl2" class="quarto-xref">Tabla&nbsp;2</a> muestra un resumen estadístico de los datos biológicos en el sitio de estudio. Se puede observar que el sitio <strong>35M</strong> destaca con la mayor abundancia media (<strong>~24</strong>) y el valor máximo más alto (<strong>1543</strong>), por el contrario, el sitio <strong>1M</strong> tiene la menor abundancia media (<strong>0.14</strong>) y el máximo más bajo (<strong>10</strong>). La desviación estándar (SD) refleja la variabilidad en la abundancia dentro de cada sitio. Sitios como <strong>35M</strong> y <strong>26M</strong> muestran una alta variabilidad (SD de <strong>167.5</strong> y <strong>150.5</strong>, respectivamente), Por otro lado, sitios como <strong>1M</strong> y <strong>9P</strong> tienen una variabilidad baja (SD de <strong>1.10</strong> y <strong>1.77</strong>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen estadístico de la base biológica</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>resumen_biologico <span class="ot">&lt;-</span> largo_biol <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Sitios) <span class="sc">%&gt;%</span>  <span class="co"># Agrupar por sitio</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Abundancia_Media =</span> <span class="fu">mean</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">Abundancia_Min =</span> <span class="fu">min</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">Abundancia_Max =</span> <span class="fu">max</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">Abundancia_SD =</span> <span class="fu">sd</span>(Abundancia, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">"drop"</span>  <span class="co"># Evita mensajes sobre agrupación</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(resumen_biologico) <span class="sc">%&gt;%</span> </span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;2: Resumen estadístico de la abundancia de peces en la cuenca del río Soto La Marina, México (seis primeras filas).
</figcaption>
<div aria-describedby="tbl-tbl2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Sitios</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Abundancia_Media</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Abundancia_Min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Abundancia_Max</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Abundancia_SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">10P</td>
<td style="text-align: right;">0.8426966</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">3.243521</td>
</tr>
<tr class="even">
<td style="text-align: left;">11M</td>
<td style="text-align: right;">2.0337079</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">9.898863</td>
</tr>
<tr class="odd">
<td style="text-align: left;">12M</td>
<td style="text-align: right;">0.8764045</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">5.202316</td>
</tr>
<tr class="even">
<td style="text-align: left;">13M</td>
<td style="text-align: right;">0.9887640</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">4.427431</td>
</tr>
<tr class="odd">
<td style="text-align: left;">14M</td>
<td style="text-align: right;">2.3932584</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">106</td>
<td style="text-align: right;">13.558474</td>
</tr>
<tr class="even">
<td style="text-align: left;">15P</td>
<td style="text-align: right;">0.9213483</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">3.049682</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="resumen-estadístico-de-la-base-de-datos-ambiental" class="level2">
<h2 class="anchored" data-anchor-id="resumen-estadístico-de-la-base-de-datos-ambiental">Resumen estadístico de la base de datos ambiental</h2>
<p>En la <a href="#tbl-tbl3" class="quarto-xref">Tabla&nbsp;3</a> muestra un resumen estadístico de los datos ambientales en el sitio de estudio. Se observa que el pH muestra una media de <strong>7.51</strong>, con valores que oscilan entre <strong>6.5</strong> y <strong>8.3</strong>, lo que indica un ambiente predominantemente neutro a ligeramente alcalino. La temperatura del agua tiene una media de <strong>27.36°C</strong>. La conductividad, con una media de <strong>641.39 µS/cm</strong> y un máximo de <strong>1655 µS/cm</strong>, refleja diferencias en la concentración de iones disueltos, posiblemente relacionadas con la presencia de sales u otros compuestos. El oxígeno disuelto, con una media de <strong>6.66 mg/L</strong>, muestra una amplia variabilidad (desde&nbsp;<strong>1.2 mg/L</strong>&nbsp;hasta&nbsp;<strong>24.9 mg/L</strong>), lo que podría indicar diferencias en la calidad del agua y la actividad fotosintética. Los nutrientes como nitritos (NO₂), nitratos (NO₃) y amonio (NH₄⁺) presentan concentraciones bajas en general, con medias de <strong>0.02 mg/L</strong>, <strong>0.5 mg/L</strong> y <strong>1.47 mg/L</strong>, respectivamente, lo que sugiere una limitada contaminación por compuestos nitrogenados. Los fosfatos, con una media de <strong>0.21 mg/L</strong>, también indican bajos niveles de contaminación por fósforo. En cuanto a la varianza, la conductividad presentó los valores más altos (<strong>140964.03 µS/cm</strong>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Selecciona solo las variables ambientales de interés</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>variables_seleccionadas <span class="ot">&lt;-</span> amb <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">pH</span><span class="st">`</span>, <span class="st">`</span><span class="at">Water temperature</span><span class="st">`</span>, <span class="st">`</span><span class="at">Conductivity</span><span class="st">`</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Salinity</span><span class="st">`</span>, <span class="st">`</span><span class="at">Transparency</span><span class="st">`</span>, <span class="st">`</span><span class="at">Oxygen</span><span class="st">`</span>, </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Carbon Dioxide</span><span class="st">`</span>, <span class="st">`</span><span class="at">Alkalinity</span><span class="st">`</span>, <span class="st">`</span><span class="at">NO2</span><span class="st">`</span>, </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">NO3</span><span class="st">`</span>, <span class="st">`</span><span class="at">Ammonium</span><span class="st">`</span>, <span class="st">`</span><span class="at">Hardness</span><span class="st">`</span>, </span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>         <span class="st">`</span><span class="at">Phosphates</span><span class="st">`</span>, <span class="st">`</span><span class="at">TDS</span><span class="st">`</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Resumen estadístico de las variables seleccionadas</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>resumen_ambiental <span class="ot">&lt;-</span> variables_seleccionadas <span class="sc">%&gt;%</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">list</span>(<span class="at">Media =</span> <span class="sc">~</span> <span class="fu">round</span> (<span class="fu">mean</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Minimo =</span> <span class="sc">~</span> <span class="fu">round</span> (<span class="fu">min</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Maximo =</span> <span class="sc">~</span> <span class="fu">round</span> (<span class="fu">max</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                        <span class="at">DE =</span> <span class="sc">~</span> <span class="fu">round</span> (<span class="fu">sd</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Varianza =</span> <span class="sc">~</span> <span class="fu">round</span> (<span class="fu">var</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Rango =</span> <span class="sc">~</span> <span class="fu">round</span> (<span class="fu">max</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">-</span> <span class="fu">min</span>(., <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Q1 =</span> <span class="sc">~</span> <span class="fu">round</span> (<span class="fu">quantile</span>(., <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Q2 =</span> <span class="sc">~</span> <span class="fu">round</span> (<span class="fu">quantile</span>(., <span class="at">probs =</span> <span class="fl">0.50</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Q3 =</span> <span class="sc">~</span> <span class="fu">round</span> (<span class="fu">quantile</span>(., <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)))) <span class="sc">%&gt;%</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">everything</span>(), </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Estadistico"</span>), </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_sep =</span> <span class="st">"_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Estadistico"</span>, <span class="at">values_from =</span> <span class="st">"value"</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>resumen_ambiental <span class="sc">%&gt;%</span> </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl3" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;3: Resumen estadístico de las variables ambientales en la cuenca del río Soto La Marina, México.
</figcaption>
<div aria-describedby="tbl-tbl3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Media</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Minimo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Maximo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">DE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Varianza</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rango</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">pH</td>
<td style="text-align: right;">7.51</td>
<td style="text-align: right;">6.50</td>
<td style="text-align: right;">8.30</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.22</td>
<td style="text-align: right;">1.80</td>
<td style="text-align: right;">7.20</td>
<td style="text-align: right;">7.55</td>
<td style="text-align: right;">7.90</td>
</tr>
<tr class="even">
<td style="text-align: left;">Water temperature</td>
<td style="text-align: right;">27.36</td>
<td style="text-align: right;">16.90</td>
<td style="text-align: right;">39.00</td>
<td style="text-align: right;">4.67</td>
<td style="text-align: right;">21.80</td>
<td style="text-align: right;">22.10</td>
<td style="text-align: right;">25.00</td>
<td style="text-align: right;">28.00</td>
<td style="text-align: right;">29.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Conductivity</td>
<td style="text-align: right;">641.39</td>
<td style="text-align: right;">231.00</td>
<td style="text-align: right;">1655.00</td>
<td style="text-align: right;">375.45</td>
<td style="text-align: right;">140964.03</td>
<td style="text-align: right;">1424.00</td>
<td style="text-align: right;">398.12</td>
<td style="text-align: right;">495.50</td>
<td style="text-align: right;">657.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Salinity</td>
<td style="text-align: right;">3.04</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">26.00</td>
<td style="text-align: right;">4.86</td>
<td style="text-align: right;">23.58</td>
<td style="text-align: right;">26.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">2.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Transparency</td>
<td style="text-align: right;">79.00</td>
<td style="text-align: right;">0.79</td>
<td style="text-align: right;">600.00</td>
<td style="text-align: right;">92.51</td>
<td style="text-align: right;">8558.78</td>
<td style="text-align: right;">599.21</td>
<td style="text-align: right;">31.25</td>
<td style="text-align: right;">64.50</td>
<td style="text-align: right;">82.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oxygen</td>
<td style="text-align: right;">6.66</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">24.90</td>
<td style="text-align: right;">5.04</td>
<td style="text-align: right;">25.42</td>
<td style="text-align: right;">23.70</td>
<td style="text-align: right;">3.67</td>
<td style="text-align: right;">5.92</td>
<td style="text-align: right;">7.39</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Carbon Dioxide</td>
<td style="text-align: right;">22.75</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">103.50</td>
<td style="text-align: right;">19.73</td>
<td style="text-align: right;">389.32</td>
<td style="text-align: right;">103.50</td>
<td style="text-align: right;">13.88</td>
<td style="text-align: right;">20.00</td>
<td style="text-align: right;">25.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Alkalinity</td>
<td style="text-align: right;">192.58</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">410.00</td>
<td style="text-align: right;">73.73</td>
<td style="text-align: right;">5436.05</td>
<td style="text-align: right;">410.00</td>
<td style="text-align: right;">135.50</td>
<td style="text-align: right;">182.10</td>
<td style="text-align: right;">233.50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NO2</td>
<td style="text-align: right;">0.02</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.02</td>
</tr>
<tr class="even">
<td style="text-align: left;">NO3</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.65</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">3.65</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.16</td>
<td style="text-align: right;">0.74</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ammonium</td>
<td style="text-align: right;">1.49</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">1.55</td>
<td style="text-align: right;">2.40</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">0.32</td>
<td style="text-align: right;">1.09</td>
<td style="text-align: right;">1.98</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hardness</td>
<td style="text-align: right;">290.69</td>
<td style="text-align: right;">92.00</td>
<td style="text-align: right;">1000.00</td>
<td style="text-align: right;">195.62</td>
<td style="text-align: right;">38266.72</td>
<td style="text-align: right;">908.00</td>
<td style="text-align: right;">172.25</td>
<td style="text-align: right;">238.00</td>
<td style="text-align: right;">350.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Phosphates</td>
<td style="text-align: right;">0.21</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.05</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.34</td>
</tr>
<tr class="even">
<td style="text-align: left;">TDS</td>
<td style="text-align: right;">362.26</td>
<td style="text-align: right;">100.00</td>
<td style="text-align: right;">998.00</td>
<td style="text-align: right;">234.19</td>
<td style="text-align: right;">54846.73</td>
<td style="text-align: right;">898.00</td>
<td style="text-align: right;">184.00</td>
<td style="text-align: right;">302.50</td>
<td style="text-align: right;">480.75</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>biol_abrev <span class="ot">&lt;-</span> largo_biol <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(Sitios, Abrev, Abundancia) <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Abrev, <span class="at">values_from =</span> Abundancia)  <span class="co">#convertir a formato ancho</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>biol_log <span class="ot">&lt;-</span> largo_biol <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(Sitios, Abrev, Abundancia) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Abrev, <span class="at">values_from =</span> Abundancia)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>columnas_numericas <span class="ot">&lt;-</span> <span class="fu">names</span>(biol_log)[<span class="dv">2</span><span class="sc">:</span><span class="dv">50</span>]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iterar sobre los nombres de las columnas</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (columna <span class="cf">in</span> columnas_numericas) {</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Manejar los NAs: reemplazarlos con 0 antes de la suma condicional</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  biol_log[[columna]][<span class="fu">is.na</span>(biol_log[[columna]])] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identificar los valores cero y sumar 1 solo a ellos</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  biol_log[[columna]][biol_log[[columna]] <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> biol_log[[columna]][biol_log[[columna]] <span class="sc">==</span> <span class="dv">0</span>] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Aplicar el logaritmo común (log10) a la columna</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  biol_log[[columna]] <span class="ot">&lt;-</span> <span class="fu">log10</span>(biol_log[[columna]])</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="exploración-gráfica-en-excel" class="level2">
<h2 class="anchored" data-anchor-id="exploración-gráfica-en-excel">Exploración gráfica en Excel</h2>
<p>La <strong><code>Figura 1</code></strong> muestra los valores promedio de conductividad, dureza y sólidos disueltos totales (TDS) por Río, con sus respectivas desviaciones estándar. Los puntos rojos representan la abundancia total de peces por Río. Se observa que, en algunos sitios como San Carlos y Santa Ana, los altos valores de conductividad podrían estar asociados con una mayor abundancia de peces, pero esta relación no se mantiene igual en todos los sitios, lo que indica que otros factores ambientales o ecológicos también influyen en la distribución y abundancia de peces.</p>
<p><img src="images/clipboard-2346192771.png" class="img-fluid"></p>
<p><strong><code>Figura 1.</code></strong> Relación entre variables ambientales del agua y la abundancia total de peces por Río.</p>
<hr>
<p>La <strong><code>figura 2</code></strong> muestra la abundancia de las seis principales especies de peces por Río. Se observa que <em>Pclm</em> y <em>Astm</em> presentan las mayores abundancias en la mayoría de los Ríos, destacándose especialmente en San Marcos y San Felipe. El taxón <em>Gmbr</em> muestra una abundancia particularmente alta en Arroyo Grande, lo que indica una posible especialización o adaptación local, ya que su presencia en los demás sitios es baja o nula. Estas diferencias en abundancia entre taxones y sitios podrían reflejar gradientes ambientales.</p>
<p><img src="images/clipboard-3907635489.png" class="img-fluid"></p>
<p><strong><code>Figura 2.</code></strong> Distribución de abundancia de las 6 principales especies de peces por Río.</p>
<hr>
</section>
<section id="exploración-gráfica" class="level2">
<h2 class="anchored" data-anchor-id="exploración-gráfica">Exploración gráfica</h2>
<section id="figura-de-elipises-con-las-especies-más-abundantes" class="level3">
<h3 class="anchored" data-anchor-id="figura-de-elipises-con-las-especies-más-abundantes">Figura de elipises con las especies más abundantes</h3>
<p>La <a href="#fig-fig1" class="quarto-xref">Figura&nbsp;1</a> representa las relaciones entre las especies de peces evaluadas. En su mayoría, se observan correlaciones positivas aunque no altamente significativas. Por ejemplo, la abundancia total tiene correlación positiva con las especies <em>Astyanax mexicanus</em> (<strong>76%</strong>), <em>Herichthys cyanoguttatus</em> (<strong>71%</strong>) y <em>Poecilia mexicana</em> (<strong>68%</strong>). Por otro lado, la mayoría de las correlaciones negativas fueron leves, lo que indica que la abundancia de una especie no parece verse fuertemente afectada por la presencia de otra.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>d_elipses <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos_PCA.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Hoja2"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformación logarítmica de las especies más abundantes</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>biol2 <span class="ot">&lt;-</span> <span class="fu">log</span>(d_elipses[, <span class="dv">40</span><span class="sc">:</span><span class="dv">52</span>] <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de correelación con las variables transformadas</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">cor</span>(biol2, <span class="at">use =</span> <span class="st">"complete.obs"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(M, <span class="at">method =</span> <span class="st">"ellipse"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig1-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;1: Relaciones lineales comparando las abundancias de peces entre sí en los diferentes ríos muestreados. Las elipses azules representas relaciones positivas y las rojas representan relaciones negativas.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="figura-de-elipses-de-los-datos-ambientales-fisicoquímicos" class="level3">
<h3 class="anchored" data-anchor-id="figura-de-elipses-de-los-datos-ambientales-fisicoquímicos">Figura de elipses de los datos ambientales fisicoquímicos</h3>
<p>La <a href="#fig-fig2" class="quarto-xref">Figura&nbsp;2</a> representa las relaciones entre las variables ambientales evaluadas. Se observa que la relación más fuerte se observó entre las variables Profundidad media de la zona muestreada (<strong>Adotsa</strong>) y Profundidad máxima (<strong>Mxmd</strong>) (<strong>96%</strong>), Salinidad (<strong>Slnt</strong>) y Anchura de la superficie del agua (<strong>Wotws</strong>) (<strong>84%</strong>), y Conductividad (<strong>Cndc</strong>) y Sólidos disueltos totales (<strong>TDS</strong>) (<strong>77%</strong>). Lo que nos indica que estás variables estarán correlacionadas al estar en valores altos o bajos en los sitios. Por otro lado, no se observan relaciones negativas fuertes entre las varibales ambientales.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">cor</span>(d_elipses[, <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">25</span><span class="sc">:</span><span class="dv">29</span>, <span class="dv">33</span>, <span class="dv">36</span>, <span class="dv">39</span>)]) <span class="co"># Matriz de correlación</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Elipses con colores</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(M2, <span class="at">method =</span> <span class="st">"ellipse"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig2-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;2: Relaciones lineales comparando datos ambientales en los diferentes ríos muestreados. Las elipses azules representas relaciones positivas y las rojas representan relaciones negativas.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="figura-de-elipses-de-los-datos-ambientales-y-biológicos-con-las-abundancias-convertidas-a-logaritmo-log10" class="level3">
<h3 class="anchored" data-anchor-id="figura-de-elipses-de-los-datos-ambientales-y-biológicos-con-las-abundancias-convertidas-a-logaritmo-log10">Figura de elipses de los datos ambientales y biológicos con las abundancias convertidas a logaritmo (<code>log10</code>)</h3>
<p>La <a href="#fig-fig3" class="quarto-xref">Figura&nbsp;3</a> muestra las relaciones entre las especies de peces y las variables ambientales evaluadas. Se observaron relaciones fuertemente positivas entre el pH y la especie <em>Gambusia</em> sp. (<strong>77%</strong>), entre la Alcalinidad (<strong>Alkl</strong>) y <em>Aplodinotus grunniens</em> (<strong>76%</strong>), y entre Amonio (<strong>Ammn</strong>) y <em>Herichthys cyanoguttatus</em> (<strong>73%</strong>). Por otro lado, para la especie <em>Gambusia regani</em> se observaron relaciones negativas con las variables Adotsa, Mxmd, Wotws, Typs (Tipo de corriente) y Slnt. La abundanica total tuvo una relación positiva con las variables Ammn (<strong>53%</strong>) y TDS (<strong>52%</strong>) y una realción negativa con Alt2 (<strong>Altitud</strong>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Mamb_biol <span class="ot">&lt;-</span> <span class="fu">cor</span>(M2, M, <span class="st">"pairwise.complete.obs"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># matriz de elipses</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(Mamb_biol, <span class="at">method =</span> <span class="st">"ellipse"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig3-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;3: Relaciones lineales comparando datos ambientales vs biologicos en los diferentes ríos muestreados. Las elipses azules representas relaciones positivas y las rojas representan relaciones negativas.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="nueva-columna-con-los-ríos-a-los-que-pertenece-cada-sitio-muestreado" class="level3">
<h3 class="anchored" data-anchor-id="nueva-columna-con-los-ríos-a-los-que-pertenece-cada-sitio-muestreado">Nueva columna con los ríos a los que pertenece cada sitio muestreado</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>biol_amb<span class="sc">$</span>Sitios <span class="ot">=</span> <span class="fu">as.factor</span>(biol_amb<span class="sc">$</span>Sitios)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>biol_amb <span class="ot">&lt;-</span> biol_amb <span class="sc">%&gt;%</span> </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Rios =</span> <span class="fu">case_when</span>(</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    Sitios <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"1M"</span>, <span class="st">"2M"</span>, <span class="st">"3P"</span>) <span class="sc">~</span> <span class="st">"Arroyo Grande"</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    Sitios <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"4M"</span>, <span class="st">"5M"</span>, <span class="st">"6P"</span>, <span class="st">"7P"</span>, <span class="st">"8M"</span>) <span class="sc">~</span> <span class="st">"Corona"</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    Sitios <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"9P"</span>, <span class="st">"10P"</span>) <span class="sc">~</span> <span class="st">"Palmas"</span>,</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    Sitios <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"11M"</span>, <span class="st">"12M"</span>, <span class="st">"13M"</span>, <span class="st">"14M"</span>, <span class="st">"15P"</span>, <span class="st">"16P"</span>) <span class="sc">~</span> <span class="st">"Pilón"</span>,</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    Sitios <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"17M"</span>, <span class="st">"18M"</span>, <span class="st">"19P"</span>, <span class="st">"20M"</span>, <span class="st">"21P"</span>, <span class="st">"22P"</span>, <span class="st">"23P"</span>) <span class="sc">~</span> <span class="st">"Purificación"</span>,</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    Sitios <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"25M"</span>, <span class="st">"26M"</span>, <span class="st">"27P"</span>) <span class="sc">~</span> <span class="st">"San Carlos"</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    Sitios <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"28M"</span>, <span class="st">"29M"</span>, <span class="st">"30M"</span>, <span class="st">"31M"</span>, <span class="st">"32M"</span>) <span class="sc">~</span> <span class="st">"San Felipe"</span>,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    Sitios <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"33M"</span>, <span class="st">"34M"</span>, <span class="st">"35M"</span>) <span class="sc">~</span> <span class="st">"San Marcos"</span>,</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    Sitios <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"36M"</span>, <span class="st">"37P"</span>, <span class="st">"38M"</span>) <span class="sc">~</span> <span class="st">"Santa Ana"</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>    Sitios <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"39P"</span>, <span class="st">"40P"</span>, <span class="st">"41P"</span>, <span class="st">"42RM"</span>, <span class="st">"43RM"</span>) <span class="sc">~</span> <span class="st">"Soto la Marina"</span>,</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Otro"</span> </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="figuras-de-cajas-y-bigotes" class="level3">
<h3 class="anchored" data-anchor-id="figuras-de-cajas-y-bigotes">Figuras de cajas y bigotes</h3>
<p>La <a href="#fig-fig4" class="quarto-xref">Figura&nbsp;4</a> muestra la distribución de las abundancias de peces en los diferentes ríos muestreados. <strong>San Carlos</strong> y <strong>Santa Ana</strong> tienen las medianas más altas, y no se superponen sus notches con las de ríos como Palmas o Soto la Marina. Esto indica diferencias significativas entre estos ríos en cuanto a la abundancia de peces. Por otro lado, <strong>Palmas</strong> exhibe la mediana más baja y una baja variabilidad, lo que sugiere un ecosistema más homogéneo y posiblemente menos favorable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Organización por nivel de magnitud</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d_elipses, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(Rios, Ab_Total),<span class="at">y=</span>Ab_Total)) <span class="sc">+</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> T, <span class="fu">aes</span>(<span class="at">fill =</span> Rios)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Ríos muestreados"</span>,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Abundancia en escala log10"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Ríos muestreados"</span>) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">size =</span> <span class="dv">14</span>),  <span class="co"># Centrar el título</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">vjust =</span> <span class="dv">1</span>, <span class="at">hjust =</span> <span class="dv">1</span>)  <span class="co"># Rotar nombres de ríos en 45°</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"skyblue"</span>, </span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"green"</span>, <span class="st">"pink"</span>, <span class="st">"brown"</span>, <span class="st">"purple"</span>, </span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"turquoise"</span>, <span class="st">"salmon"</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig4-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;4: Variación en la abundancia de peces para los 10 ríos evaluados
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="figuras-multivaraidas-de-cajas-y-bigotes" class="level3">
<h3 class="anchored" data-anchor-id="figuras-multivaraidas-de-cajas-y-bigotes">Figuras multivaraidas de Cajas y bigotes</h3>
<p>La <a href="#fig-fig5" class="quarto-xref">Figura&nbsp;5</a> muestra la distribución de la abundancia de peces (<strong>en escala log10</strong>) en relación con diferentes variables ambientales y según el río muestreado. <strong>El primer panel</strong> muestra la relación entre la abundancia y la profundidad promedio del sitio de muestreo; Soto la Marina presenta las mayores abundancias asociadas con mayor profundidad. <strong>El segundo pane</strong>l muestra la relación entre la abundancia y la especie <em>Poecilia mexicana</em>; San Felipe presenta una alta abundancia en sitios donde esta especie está altamente presente. <strong>El tercer panel</strong> muestra la relación entre la abundancia y los sólidos disueltos totales; Soto la Marina y Corona presentan mayores medianas de abundancia asociadas con mayores valores de TDS.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Figuras multivariadas de Cajas y bigotes</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>d_elipses <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(d_elipses)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">melt</span>(d_elipses[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">40</span>,<span class="dv">39</span>,<span class="dv">26</span>))]), <span class="fu">aes</span>(<span class="at">x=</span>variable, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Rios)) <span class="sc">+</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"skyblue"</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"green"</span>, <span class="st">"pink"</span>, <span class="st">"brown"</span>, <span class="st">"purple"</span>, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"turquoise"</span>, <span class="st">"salmon"</span>)) <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">""</span>,<span class="at">y=</span><span class="st">"Abundancia en escala log10"</span>) <span class="sc">+</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable,<span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig5" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig5-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;5: Variación en la abundancia de diferentes peces para los diez ríos evaluados.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="regresión-lineal-entre-la-abundancia-y-la-altitud" class="level3">
<h3 class="anchored" data-anchor-id="regresión-lineal-entre-la-abundancia-y-la-altitud">Regresión lineal entre la abundancia y la Altitud</h3>
<p>La <a href="#fig-fig6" class="quarto-xref">Figura&nbsp;6</a> muestra una regresión lineal entre la abundancia total de peces y la altitud. Se puede observar un comportamiento lineal ligeramente positivo de las abundancias respecto a la altitud, donde a medida que va aumentanto la altitud, también tiende a aumentar la abundacia de peces. Además, se observa que la mayoría de las abundancias se agrupan en altitudes entre 100 y 500 metros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Figuras de regresión entre la abundancia y la Altitud</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d_elipses, <span class="fu">aes</span>(<span class="at">x =</span> Alt2, <span class="at">y =</span> Ab_Total) )<span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Rios), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span> <span class="st">"lm"</span>) <span class="sc">+</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de la Abundancia según la Altitud"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Altitud"</span>,</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Abundancia en escala log10"</span>)<span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig6" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig6-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6: Gráfico de regresiones lineales comparando las abundancias en distintas altitudes.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="regresión-suavizada-entre-la-abundancia-y-la-altitud" class="level3">
<h3 class="anchored" data-anchor-id="regresión-suavizada-entre-la-abundancia-y-la-altitud">Regresión suavizada entre la abundancia y la Altitud</h3>
<p>La <a href="#fig-fig7" class="quarto-xref">Figura&nbsp;7</a> muestra una regresión suavizada entre la abundancia total de peces y la altitud. Se observa una relación de tipo no lineal, que al ser suavizada se ajusta en mejor medidad a los datos dispersos, con una mayor abundancia en las altitudes entre los 200 y 450 metros.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Figuras de regresión entre la abundancia y la Altitud</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d_elipses, <span class="fu">aes</span>(<span class="at">x =</span> Alt2, <span class="at">y =</span> Ab_Total) )<span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Rios), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribución de la Abundancia según la Altitud"</span>,</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Altitud"</span>,</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Abundancia en escala log10"</span>)<span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig7" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig7-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;7: Grafico de regresiones suavizadas comparando las abundancias en distintas altitudes.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="regresión-lineal-entre-la-abundancia-y-los-sólidos-disueltos-totales-tds" class="level3">
<h3 class="anchored" data-anchor-id="regresión-lineal-entre-la-abundancia-y-los-sólidos-disueltos-totales-tds">Regresión lineal entre la abundancia y los Sólidos Disueltos Totales (TDS)</h3>
<p>La <a href="#fig-fig8" class="quarto-xref">Figura&nbsp;8</a> muestra una regresión lineal entre la abundancia y los Sólidos Totales Disueltos. Se puede observar un comportamiento lineal ligeramente negativo de las abundancias respecto a TDS, donde a medida que va aumentando TDS, tienden a disminuir las abundancias de peces. Además, se observa que la mayoría de las abundancias se agrupan en en TDS entre 100 y 375 ppm.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regresion lineal entre la abundancia y la Conuductividad</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d_elipses, <span class="fu">aes</span>(<span class="at">x=</span> TDS, <span class="at">y=</span> Ab_Total)  ) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Rios), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span> <span class="st">"lm"</span>)<span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relación de la Abundancia según los Sólidos Disueltos Totales"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sólidos Disueltos Totales"</span>,</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Abundancia en escala log10"</span>)<span class="sc">+</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig8" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig8-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;8: Grafico de regresiones lineales comparando las abundancias con los Sólidos Disueltos Totales.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="regresión-suavizada-entre-la-abundancia-y-los-sólidos-disueltos-totales" class="level3">
<h3 class="anchored" data-anchor-id="regresión-suavizada-entre-la-abundancia-y-los-sólidos-disueltos-totales">Regresión suavizada entre la abundancia y los Sólidos Disueltos Totales</h3>
<p>La <a href="#fig-fig9" class="quarto-xref">Figura&nbsp;9</a> muestra la variación de la abundancia de organismos en función de TDS en los diferentes Ríos muestreados. La curva de regresión suavizada sugiere que la abundancia es menor en valores cercanos a 0 ppm, pero también cuando estos valores son superiores 375 ppm.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Regresion lineal entre la abundancia y el pH</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(d_elipses, <span class="fu">aes</span>(<span class="at">x=</span> TDS, <span class="at">y=</span> Ab_Total)  ) <span class="sc">+</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> Rios), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">span =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Relación de la Abundancia según los Sólidos Disueltos Totales"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Sólidos Disueltos Totales"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Abundancia en escala log10"</span>)<span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig9" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig9-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;9: Grafico de regresiones suavizadas comparando las abundancias con Sólidos Disueltos Totales.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="grafico-de-burbujas" class="level3">
<h3 class="anchored" data-anchor-id="grafico-de-burbujas">Grafico de burbujas</h3>
<p>En la <a href="#fig-fig10" class="quarto-xref">Figura&nbsp;10</a> se puede observar que las abundancias estuvieron entre el nivel de pH 6.5 y 8.4, donde fuera de este rango no se registraron muchos individuos. La especie que mayores abundancias regitraron fueron: Pcml con 1500 individuos a un nivel de 8 y Gmbr con 1500 individuos en un nivel de 7.4. El río Arroyo Grande tuvo restringidas sus abundancias en el nivel de pH 6.7. Las abundancias de especies como Pclf, Hrcc y Astm se distribuyeron uniformemente entre los valores de pH 6.5 y 8.4 con menos de 500 individuos por sitio.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Preparar breviar nombres de los grupos taxonómicos</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>biol_amb <span class="ot">&lt;-</span> biol_amb <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(Abundancia)) <span class="sc">%&gt;%</span>  </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">Abrev =</span> <span class="fu">fct_inorder</span>(Abrev)  </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Abundancia<span class="sc">&gt;</span><span class="dv">10</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de burbujas</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(biol_amb, <span class="fu">aes</span>(<span class="at">x =</span> pH, <span class="at">y =</span> Abrev, <span class="at">size =</span> Abundancia, <span class="at">color =</span> Rios)) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Líneas verticales para valores de pH</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">xintercept =</span> <span class="fu">seq</span>(<span class="fl">6.4</span>, <span class="fl">8.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">linetype =</span> <span class="st">"dashed"</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> <span class="fl">0.3</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Escalas y ejes</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_size</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="at">name =</span> <span class="st">"Abundancia"</span>) <span class="sc">+</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">6.4</span>, <span class="fl">8.5</span>),</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">6.4</span>, <span class="fl">8.5</span>, <span class="at">by =</span> <span class="fl">0.5</span>),</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_discrete</span>(<span class="at">limits =</span> rev) <span class="sc">+</span>  </span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Configuración del tema sin líneas de grid</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),  </span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel.border =</span> <span class="fu">element_rect</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">fill =</span> <span class="cn">NA</span>),</span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>, <span class="at">margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">10</span>)),</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"right"</span>,</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.box =</span> <span class="st">"vertical"</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"pH"</span>,</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Especies"</span>,</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"Ríos"</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="cn">NULL</span>, </span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>                        <span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">shape =</span> <span class="dv">1</span>, </span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">color =</span> <span class="st">"#377eb8"</span>,</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">stroke =</span> <span class="fl">1.2</span>)),  </span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Circulos de las Layers en la leyenda</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="cn">NULL</span>)   <span class="co">#  Eliminar el título de la leyenda para "group"</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig10" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig10-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;10: Grafico de burbujas comparando las abundancias con el nivel de pH en los diferentes Ríos.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="pca" class="level2">
<h2 class="anchored" data-anchor-id="pca">PCA</h2>
<section id="ajuste-de-las-bases-de-datos-fisiqcoquimica-amb-y-biológica-tax.hel" class="level3">
<h3 class="anchored" data-anchor-id="ajuste-de-las-bases-de-datos-fisiqcoquimica-amb-y-biológica-tax.hel">1. Ajuste de las bases de datos fisiqcoquimica (amb) y biológica (tax.hel)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>d_elipses <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos_PCA.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Hoja2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>d_elipses<span class="sc">$</span>Rios <span class="ot">=</span> <span class="fu">as.factor</span> (d_elipses<span class="sc">$</span>Rios)   <span class="co"># factor</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables ambientales con transformación logarítmica</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>amb1<span class="ot">=</span><span class="fu">log10</span>(d_elipses[,<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">25</span><span class="sc">:</span><span class="dv">29</span>, <span class="dv">33</span>, <span class="dv">36</span>, <span class="dv">39</span>)]<span class="sc">+</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables biológicas linealizadas - Taxones con Hellinger</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>tax.hel<span class="ot">=</span><span class="fu">decostand</span>(d_elipses[,<span class="fu">c</span>(<span class="dv">40</span><span class="sc">:</span><span class="dv">51</span>)],<span class="st">"hellinger"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pca-con-paquete-factoextra" class="level3">
<h3 class="anchored" data-anchor-id="pca-con-paquete-factoextra"><strong>2. PCA con paquete factoextra</strong></h3>
<p>La <a href="#tbl-tbl4" class="quarto-xref">Tabla&nbsp;4</a> muestra que la varianza acumulada de los dos primeros componentes principales es 0.66 o del 66%, lo cual indica una buena configuración de los datos para la ordenación del PCA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Variables ambientales con transformación logarítmica</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>amb1<span class="ot">=</span><span class="fu">log10</span>(d_elipses[,<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">8</span>, <span class="dv">25</span><span class="sc">:</span><span class="dv">29</span>, <span class="dv">33</span>, <span class="dv">36</span>, <span class="dv">39</span>)]<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># PCA</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>pca1 <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(amb1)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca1)<span class="sc">$</span><span class="st">"importance"</span>[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>] <span class="sc">%&gt;%</span> </span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl4" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;4: Porcentaje de varianza de los dos primeros componentes principales
</figcaption>
<div aria-describedby="tbl-tbl4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PC2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Standard deviation</td>
<td style="text-align: right;">0.7361981</td>
<td style="text-align: right;">0.3863051</td>
</tr>
<tr class="even">
<td style="text-align: left;">Proportion of Variance</td>
<td style="text-align: right;">0.5178600</td>
<td style="text-align: right;">0.1425900</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cumulative Proportion</td>
<td style="text-align: right;">0.5178600</td>
<td style="text-align: right;">0.6604500</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
<section id="contribución-eje-1" class="level4">
<h4 class="anchored" data-anchor-id="contribución-eje-1"><strong>2.1. Contribución eje 1</strong></h4>
<p>La <a href="#fig-fig11" class="quarto-xref">Figura&nbsp;11</a> muestra aquellas variables más influyentes y que superen el umbral de contribución (por encima de la línea roja punteada) para el primer componente principal, donde Sólidos Disueltos Totales (<strong>TDS</strong>) fue la variable ambiental que más contribuyó, seguido de Profundidad Media de la Zona Muestreada (<strong>Adotsa</strong>), Anchura de la superficie del agua (<strong>Wotws</strong>), Profundidad máxima (<strong>Mxmd</strong>) y Altitud (<strong>Alt2</strong>). Esto indica que estas variables tienen un papel clave en la diferenciación de los sitios analizados y probablemente en la estructuración de las comunidades&nbsp;de&nbsp;peces.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.1 Contribución del eje 1</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_contrib</span>(pca1,<span class="at">choice=</span><span class="st">"var"</span>,<span class="at">axes=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Contribución de las variables en el PC1"</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                  <span class="at">y =</span> <span class="st">"Contribuciones (%)"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x=</span> <span class="st">"Variables ambientales"</span>) <span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>(), <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">hjust =</span> <span class="dv">1</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig11" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig11-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig11-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;11: Patrón de importancia de las variables ambientales en el primer componente principal
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="pca-con-ggplot" class="level3">
<h3 class="anchored" data-anchor-id="pca-con-ggplot">3. PCA con ggplot</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>d_elipses <span class="ot">&lt;-</span> d_elipses <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Zona =</span> <span class="fu">case_when</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    Alt2 <span class="sc">&lt;=</span> <span class="dv">10</span>  <span class="sc">~</span> <span class="st">"Baja"</span>,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    Alt2 <span class="sc">&gt;=</span> <span class="dv">11</span>  <span class="sc">&amp;</span> Alt2 <span class="sc">&lt;</span> <span class="dv">199</span> <span class="sc">~</span> <span class="st">"Medio"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    Alt2 <span class="sc">&gt;</span> <span class="dv">200</span>  <span class="sc">~</span> <span class="st">"Alto"</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(tax.hel)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="coordenadas-de-los-sitios-y-el-factor-coord.sit" class="level4">
<h4 class="anchored" data-anchor-id="coordenadas-de-los-sitios-y-el-factor-coord.sit"><strong>3.1. Coordenadas de los sitios y el factor “coord.sit</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.1 Coordenadas de los sitios y el factor “coord.sit"</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>coord.sit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])     <span class="co"># Coordenadas de los sitios</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>coord.sit<span class="sc">$</span>sitios <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.sit)     <span class="co"># Crear una columna con nombres de los sitios</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>coord.sit<span class="sc">$</span>grp <span class="ot">&lt;-</span>  d_elipses<span class="sc">$</span>Zona            <span class="co"># Adicionar columna de grupos por Zona</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="coordenadas-de-los-taxones-coord.tax" class="level4">
<h4 class="anchored" data-anchor-id="coordenadas-de-los-taxones-coord.tax"><strong>3.2. Coordenadas de los taxones “coord.tax”</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.2 Coordenadas de los taxones “coord.tax”</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>coord.tax <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pca<span class="sc">$</span>rotation[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])    <span class="co"># Dos primeros ejes</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>coord.tax<span class="sc">$</span>especies <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.tax)         <span class="co"># Insertar columna con nombres de las especies</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="coordenadas-de-las-ambientales-coord.amb" class="level4">
<h4 class="anchored" data-anchor-id="coordenadas-de-las-ambientales-coord.amb"><strong>3.3. Coordenadas de las ambientales “coord.amb”</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.3 Coordenadas de las ambientales “coord.amb”</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>amb2 <span class="ot">=</span> <span class="fu">envfit</span>(pca,amb1) </span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>coord.amb <span class="ot">=</span> <span class="fu">as.data.frame</span>(amb2<span class="sc">$</span><span class="st">"vectors"</span><span class="sc">$</span>arrows[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co"># coord.amb = as.data.frame(scores(amb2, "vectors"))</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>coord.amb<span class="sc">$</span>amb1 <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.amb)  </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="figura-con-de-elipses-por-concavidades---geom_mark_hull" class="level4">
<h4 class="anchored" data-anchor-id="figura-con-de-elipses-por-concavidades---geom_mark_hull"><strong>3.4. Figura con de elipses por concavidades - geom_mark_hull</strong></h4>
<p>La <a href="#fig-fig12" class="quarto-xref">Figura&nbsp;12</a> muestra que a mayor altitud (grupo “Alto”), algunas variables biológicas como <em>Poecilia mexicana</em> y la abundancia total están más correlacionadas negativamente con el PC1, lo cual podría estar relacionado con cambios en la composición de especies o condiciones ambientales. En contraste, el grupo “Bajo” se separa claramente hacia la parte superior derecha, posiblemente por la influencia de variables como Salinidad y Conductividad.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4.4 Figura con de elipses por concavidades - geom_mark_hull</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># *Sitios</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(PC1,PC2,<span class="at">label=</span><span class="fu">row.names</span>(coord.sit)),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span>   <span class="co"># Muestra el cuadro de la figura</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(PC1,PC2,<span class="at">colour=</span>grp),<span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Taxones  *valores de cero para caracteres de las flechas (arrow)</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> coord.tax,<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> PC1, <span class="at">yend =</span> PC2), </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle=</span><span class="dv">0</span>,<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">0</span>,<span class="st">"cm"</span>),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),<span class="at">linetype=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">0</span>,<span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.tax,<span class="fu">aes</span>(PC1,PC2,<span class="at">label=</span>especies),<span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ambiental  </span></span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> coord.amb,<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> PC1<span class="sc">/</span><span class="fl">2.5</span>, <span class="at">yend =</span> PC2<span class="sc">/</span><span class="fl">2.5</span>), </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle=</span><span class="fl">22.5</span>,<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>,<span class="st">"cm"</span>),</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">"closed"</span>),<span class="at">linetype=</span><span class="dv">1</span>, <span class="at">size=</span><span class="fl">0.6</span>,<span class="at">colour =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.amb,<span class="fu">aes</span>(PC1,PC2,<span class="at">label=</span><span class="fu">row.names</span>(coord.amb)),</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">colour =</span> <span class="st">"#00abff"</span>)<span class="sc">+</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mark_hull</span>(<span class="at">data=</span>coord.sit, <span class="fu">aes</span>(<span class="at">x=</span>PC1,<span class="at">y=</span>PC2,<span class="at">fill=</span>grp,<span class="at">group=</span>grp,</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">colour=</span>grp),<span class="at">alpha=</span><span class="fl">0.15</span>)  <span class="sc">+</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>,<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>))<span class="sc">+</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig12" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig12-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig12-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;12: Ordenación de los tributarios, la composición de las especies de peces y las variables ambientales.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="figura-con-de-elipses-por-cada-zona" class="level4">
<h4 class="anchored" data-anchor-id="figura-con-de-elipses-por-cada-zona"><strong>3.5. Figura con de elipses por cada zona</strong></h4>
<p>En la figura <a href="#fig-fig13" class="quarto-xref">Figura&nbsp;13</a> se observo un agrupamiento de las variables biologicas en los tres sitios, donde se observaron diferencias entre las especies en zonas altas con las dos zonas restantes. Se observo una maypr variabilidad en el el grupo medio, debido a que es el que mayor largo y ancho poseen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_pca_ind</span>(pca1, <span class="at">geom.ind =</span> <span class="st">"point"</span>, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">col.ind =</span> d_elipses<span class="sc">$</span>Zona,   <span class="co"># Colores por grupo - río</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>, <span class="st">"#E7B800"</span>, <span class="st">"red"</span>),</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">addEllipses =</span> <span class="cn">TRUE</span>, <span class="at">ellipse.type =</span> <span class="st">"confidence"</span>,</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.title =</span> <span class="st">"Zonas"</span>) <span class="sc">+</span> </span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>             <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"PC2"</span>,</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">x=</span> <span class="st">"PC1"</span>) <span class="sc">+</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid =</span> <span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig13" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig13-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig13-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;13: Distribución de las variables ambientales y especies en el espacio de componentes principales por cada zona de altitud con la libreria factorextra
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="nmds" class="level2">
<h2 class="anchored" data-anchor-id="nmds">NMDS</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bases datos</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>spe <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"peces marinos méxico_biológicos.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Hoja2"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"peces marinos méxico_ambientales.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Hoja2"</span>,<span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>spe <span class="ot">&lt;-</span> spe <span class="sc">%&gt;%</span> </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">90</span>)))</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>env <span class="ot">&lt;-</span> env <span class="sc">%&gt;%</span> </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select_at</span>(<span class="fu">vars</span>(<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">7</span>, <span class="dv">24</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">27</span>, <span class="dv">35</span>, <span class="dv">38</span>)))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformación de abundancias</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>spe.h <span class="ot">=</span> <span class="fu">decostand</span>(spe, <span class="st">"hellinger"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">round</span>(spe.h,<span class="dv">3</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">Hyps</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Atrs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Elps</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mgla</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Albv</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Angr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Myrp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ancm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Anch</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Brvg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Brvp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Drsc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Drsp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hrnj</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Opso</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cmpa</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cypl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cypc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dnde</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dsp.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NagÃ±</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mxsc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Astm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Arpf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Amrm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Amrn</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ictl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ictp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Isp.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pylo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Synf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Prcp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Djsm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mglc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mmbm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mndb</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hmrb</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Strt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Fndg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lcnp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gmbsaf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gmbsar</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gmbr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gsp.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pclf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pcll</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pclm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Psp.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Xphv</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Prnr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cntu</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mycb</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Srra</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lpmm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Msp.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Crnc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Crnh</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Crnl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Olgs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Trcc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Trcf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ltjnscm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ltjnscy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ltjg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dpta</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dptr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ecnm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Grrc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Anss</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Arcp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lgdr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Aplg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Brdc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Brdr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cyna</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cynn</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lstx</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mcru</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pgnc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hrcl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hrcc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Orca</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Drmm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gbmd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gbno</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Scmr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Etrc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Achl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Symc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.205</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.397</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.229</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.470</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.384</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.205</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.877</td>
<td style="text-align: right;">0.480</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.258</td>
<td style="text-align: right;">0.279</td>
<td style="text-align: right;">0.238</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.774</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.445</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.457</td>
<td style="text-align: right;">0.216</td>
<td style="text-align: right;">0.389</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.117</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.579</td>
<td style="text-align: right;">0.155</td>
<td style="text-align: right;">0.251</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.063</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">0.669</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.313</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
<hr>
<section id="ordenación-con-nmds---paquete-vegan" class="level3">
<h3 class="anchored" data-anchor-id="ordenación-con-nmds---paquete-vegan"><strong>1. Ordenación con NMDS - paquete vegan</strong></h3>
<section id="paso-1.-correr-el-nmds-y-analizar-la-disitancia-usada-y-el-estrés" class="level4">
<h4 class="anchored" data-anchor-id="paso-1.-correr-el-nmds-y-analizar-la-disitancia-usada-y-el-estrés"><strong>Paso 1. Correr el NMDS y analizar la disitancia usada y el estrés</strong></h4>
<p>La distancia utilizada es la Bray-Curtis. El estrés es 0.13 (13%), que corresponde a una buena configuración del análisis multivariado.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escalamiento multidimensional "spe.nmds"</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>spe.mds <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(spe.h, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">distance =</span> <span class="st">"bray"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>spe.mds</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
metaMDS(comm = spe.h, distance = "bray", trace = FALSE) 

global Multidimensional Scaling using monoMDS

Data:     spe.h 
Distance: bray 

Dimensions: 2 
Stress:     0.1304423 
Stress type 1, weak ties
Best solution was not repeated after 20 tries
The best solution was from try 12 (random start)
Scaling: centring, PC rotation, halfchange scaling 
Species: expanded scores based on 'spe.h' </code></pre>
</div>
</div>
</section>
<section id="paso-2.-figuras-del-nmds-con-el-paquete-vegan" class="level4">
<h4 class="anchored" data-anchor-id="paso-2.-figuras-del-nmds-con-el-paquete-vegan"><strong>Paso 2. Figuras del nmds con el paquete “vegan”</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Figura con todas las especies</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.mds,<span class="at">type =</span> <span class="st">"t"</span>,<span class="at">cex=</span><span class="fl">1.2</span>,     <span class="co"># type="t" grafica sitios y especies</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Dim 2"</span>, <span class="at">xlab=</span><span class="st">"Dim 1"</span>,     <span class="co"># main: Título de la figura</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"nMDS/Estrés ="</span>,     </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">round</span>(spe.mds<span class="sc">$</span>stress, <span class="dv">3</span>)))      <span class="co"># spe.mds$stress: valor del estrés</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="estudio-de-caso_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="figura-del-nmds-con-el-comando-orditorp" class="level4">
<h4 class="anchored" data-anchor-id="figura-del-nmds-con-el-comando-orditorp"><strong>Figura del NMDS con el comando <em>orditorp</em></strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Figura sin solapamiento de especies - comando "orditorp"</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.mds,<span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">display =</span> <span class="fu">c</span>(<span class="st">"sites"</span>, <span class="st">"species"</span>),          <span class="co"># type="n" sin texto.</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Dim 2"</span>, <span class="at">xlab=</span><span class="st">"Dim 1"</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"nMDS/Estrés ="</span>,             <span class="co"># R?tulo del título.</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">round</span>(spe.mds<span class="sc">$</span>stress, <span class="dv">3</span>)))</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(spe.mds, <span class="at">display=</span><span class="st">"sites"</span>,                 <span class="co"># Grafica los sitios</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">pos=</span><span class="dv">3</span>)</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>ordi<span class="ot">=</span> <span class="fu">orditorp</span>(spe.mds, <span class="at">display =</span> <span class="st">"species"</span>,   <span class="co"># Grafica especies sin solapar</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">shrink =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">type=</span><span class="st">"n"</span>,<span class="at">cex=</span><span class="fl">1.2</span>) </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(spe.mds, <span class="at">display =</span> <span class="st">"sites"</span>,             <span class="co"># Opcional - puntos de muestreo</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig14" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig14-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig14-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;14: Ordenación de las especies de peces con los sitios evaluados.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="figura-del-nmds-con-variables-ambientales" class="level4">
<h4 class="anchored" data-anchor-id="figura-del-nmds-con-variables-ambientales"><strong>Figura del NMDS con variables ambientales</strong></h4>
<p>Al observar como se relacionan los vectores de las variables ambientales con los ejes del NMDS, donde se obtuvieron variables que contribuyen significativamente, como lo son: Adotsa, Wotws, Alt2, Cndc, Slnt. Las variables que obtuvieron mayor contribución se tuvieron en cuenta para realizar la exploración grafica.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Insertar variables ambientales al nMDS</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ambientales (env)</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>env1 <span class="ot">=</span> <span class="fu">envfit</span>(spe.mds,env)</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>env1</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
***VECTORS

          NMDS1    NMDS2     r2 Pr(&gt;r)    
Wrtrt  -0.29365  0.95591 0.0346  0.508    
Artm   -0.23355  0.97234 0.0918  0.172    
Adotsa  0.84918  0.52810 0.5008  0.004 ** 
Mxmd    0.80094  0.59874 0.4419  0.005 ** 
Wotws   0.99854 -0.05405 0.7814  0.001 ***
Typs    0.99948  0.03236 0.1859  0.030 *  
Alt2   -0.78296 -0.62207 0.4662  0.001 ***
Cndc    0.94445 -0.32864 0.4187  0.001 ***
Ammn    0.60710 -0.79462 0.0241  0.613    
TDS     0.95777 -0.28755 0.3759  0.001 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
Permutation: free
Number of permutations: 999</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Figura sin solapamiento de especies - comando "orditorp"</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(spe.mds,<span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">display =</span> <span class="fu">c</span>(<span class="st">"sites"</span>, <span class="st">"species"</span>),          <span class="co"># type="n" sin texto.</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Dim 2"</span>, <span class="at">xlab=</span><span class="st">"Dim 1"</span>,</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"nMDS/Estrés ="</span>,             <span class="co"># R?tulo del título.</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">round</span>(spe.mds<span class="sc">$</span>stress, <span class="dv">3</span>)))</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(spe.mds, <span class="at">display=</span><span class="st">"sites"</span>,                 <span class="co"># Grafica los sitios</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>, <span class="at">pos=</span><span class="dv">3</span>)</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>ordi<span class="ot">=</span> <span class="fu">orditorp</span>(spe.mds, <span class="at">display =</span> <span class="st">"species"</span>,   <span class="co"># Grafica especies sin solapar</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">shrink =</span> <span class="cn">FALSE</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">type=</span><span class="st">"n"</span>,<span class="at">cex=</span><span class="fl">1.2</span>) </span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(env1,<span class="at">p.max=</span><span class="fl">0.05</span>,<span class="at">col=</span><span class="dv">3</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(spe.mds, <span class="at">display =</span> <span class="st">"sites"</span>,             <span class="co"># Opcional - puntos de muestreo</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">lwd=</span><span class="fl">1.5</span>)</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">4</span>)</span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">4</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="estudio-de-caso_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="generación-de-factores-variables-agrupadoras" class="level3">
<h3 class="anchored" data-anchor-id="generación-de-factores-variables-agrupadoras"><strong>Generación de factores (variables agrupadoras)</strong></h3>
<p>En la <a href="#tbl-tbl5" class="quarto-xref">Tabla&nbsp;5</a> se realizo 3 agrupaciones de los datos biologicos de las especies, teniendo en cuenta las 3 zonas de altitud.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>datos.w <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">vegdist</span>(spe), <span class="st">"ward.D"</span>)  <span class="co"># Grupos con Cluster con ward</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">cutree</span>(datos.w, <span class="at">k =</span> <span class="dv">3</span>)        <span class="co"># Generar 4 grupos (factor gr)</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>datos.gr<span class="ot">=</span><span class="fu">data.frame</span>(gr,spe)         <span class="co"># Base de datos con el factor agrupador</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>datos.gr<span class="sc">$</span>gr<span class="ot">=</span><span class="fu">as.factor</span>(datos.gr<span class="sc">$</span>gr)  <span class="co"># Crear la columna gr como factor</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Presentación de la tabla con las 10 primeras filas</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>datos.gr[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,] <span class="sc">%&gt;%</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">booktabs =</span> F) <span class="sc">%&gt;%</span> </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl5" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;5: Resumen con las 10 primeras filas de los datos de abundancia de peces, clasificados en tres grupos (k = 3)
</figcaption>
<div aria-describedby="tbl-tbl5-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">gr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hyps</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Atrs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Elps</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mgla</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Albv</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Angr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Myrp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ancm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Anch</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Brvg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Brvp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Drsc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Drsp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hrnj</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Opso</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cmpa</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cypl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cypc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dnde</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dsp.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NagÃ.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mxsc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Astm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Arpf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Amrm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Amrn</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ictl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ictp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Isp.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pylo</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Synf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Prcp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Djsm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mglc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mmbm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mndb</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hmrb</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Strt</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Fndg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lcnp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gmbsaf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gmbsar</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gmbr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gsp.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pclf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pcll</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pclm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Psp.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Xphv</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Prnr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cntu</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mycb</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Srra</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lpmm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Msp.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Crnc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Crnh</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Crnl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Olgs</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Trcc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Trcf</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ltjnscm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ltjnscy</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ltjg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dpta</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dptr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Ecnm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Grrc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Anss</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Arcp</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lgdr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Aplg</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Brdc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Brdr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cyna</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cynn</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Lstx</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mcru</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pgnc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hrcl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Hrcc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Orca</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Drmm</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gbmd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Gbno</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Scmr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Etrc</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Achl</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Symc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">48</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">41</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">432</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">250</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">333</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">426</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">330</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">67</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1372</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">76</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">164</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">315</td>
<td style="text-align: right;">20</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="ordenación-nmds-con-ggplot2" class="level3">
<h3 class="anchored" data-anchor-id="ordenación-nmds-con-ggplot2"><strong>2. Ordenación NMDS con ggplot2</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Escalamiento multidimensional "spe.nmds"</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>spe.mds <span class="ot">&lt;-</span> <span class="fu">metaMDS</span>(spe.h, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">distance =</span> <span class="st">"bray"</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">trace =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="coordenadas-de-los-sitios-y-el-factor-coord.sit-1" class="level4">
<h4 class="anchored" data-anchor-id="coordenadas-de-los-sitios-y-el-factor-coord.sit-1"><strong>2.1 Coordenadas de los sitios y el factor “coord.sit”</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>coord.sit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(spe.mds<span class="sc">$</span>points)      <span class="co"># Coordenadas de los sitios</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>coord.sit<span class="sc">$</span>sitio <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.sit)          <span class="co"># Crear una columna con nombres de los sitios</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>coord.sit<span class="sc">$</span>grp <span class="ot">&lt;-</span>  datos.gr<span class="sc">$</span>gr                   <span class="co"># Adicionar columna de grupos por especie</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(coord.sit)<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"NMDS1"</span>,<span class="st">"NMDS2"</span>,<span class="st">"sitio"</span>,<span class="st">"grp"</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coord.sit) <span class="sc">%&gt;%</span> </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl6" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;6: Primeras seis filas de las coordenadas de los sitios
</figcaption>
<div aria-describedby="tbl-tbl6-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">NMDS1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NMDS2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">sitio</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">grp</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-0.2429981</td>
<td style="text-align: right;">0.1192068</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.0256231</td>
<td style="text-align: right;">-1.6205289</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.8062675</td>
<td style="text-align: right;">1.0052534</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.5663309</td>
<td style="text-align: right;">-0.3689451</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">-0.7247143</td>
<td style="text-align: right;">-0.0675012</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">-0.6252538</td>
<td style="text-align: right;">-0.2831534</td>
<td style="text-align: left;">6</td>
<td style="text-align: left;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="coordenadas-de-las-especies-coord.esp" class="level4">
<h4 class="anchored" data-anchor-id="coordenadas-de-las-especies-coord.esp"><strong>2.2 Coordenadas de las especies “coord.esp”</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Obtener coordenadas de especies (usando el método correcto para metaMDS)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>coord.esp <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(spe.mds<span class="sc">$</span>species)  <span class="co"># Alternativa directa</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="co"># O la forma más robusta:</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>coord.esp <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(vegan<span class="sc">::</span><span class="fu">scores</span>(spe.mds, <span class="at">display =</span> <span class="st">"species"</span>, <span class="at">choices =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Añadir nombres de especies</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>coord.esp<span class="sc">$</span>especies <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.esp)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar primeras filas (con kableExtra si lo deseas)</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coord.esp) <span class="sc">%&gt;%</span> </span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl7" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;7: Primeras seis filas de las coordenadas de las especies
</figcaption>
<div aria-describedby="tbl-tbl7-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NMDS1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NMDS2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">especies</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Hyps</td>
<td style="text-align: right;">3.415370</td>
<td style="text-align: right;">1.2963599</td>
<td style="text-align: left;">Hyps</td>
</tr>
<tr class="even">
<td style="text-align: left;">Atrs</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: right;">NaN</td>
<td style="text-align: left;">Atrs</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Elps</td>
<td style="text-align: right;">3.693978</td>
<td style="text-align: right;">0.5910357</td>
<td style="text-align: left;">Elps</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mgla</td>
<td style="text-align: right;">3.415370</td>
<td style="text-align: right;">1.2963599</td>
<td style="text-align: left;">Mgla</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Albv</td>
<td style="text-align: right;">4.230220</td>
<td style="text-align: right;">-0.7665157</td>
<td style="text-align: left;">Albv</td>
</tr>
<tr class="even">
<td style="text-align: left;">Angr</td>
<td style="text-align: right;">4.230220</td>
<td style="text-align: right;">-0.7665157</td>
<td style="text-align: left;">Angr</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="coordenadas-de-las-ambientales-coord.amb-1" class="level4">
<h4 class="anchored" data-anchor-id="coordenadas-de-las-ambientales-coord.amb-1"><strong>2.3 Coordenadas de las ambientales “coord.amb”</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>amb <span class="ot">=</span> <span class="fu">envfit</span>(spe.mds,env) </span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>coord.amb <span class="ot">=</span> <span class="fu">as.data.frame</span>(amb<span class="sc">$</span>vectors<span class="sc">$</span>arrows)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>coord.amb<span class="sc">$</span>amb <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.amb)         <span class="co"># Insertar columna con nombres de las ambientales</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coord.amb) <span class="sc">%&gt;%</span> </span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span><span class="cn">FALSE</span>)</span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Para los casos en los que "vectors" no funcione, aplicar:</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># coord.amb = as.data.frame(amb$vectors$arrows)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl8" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;8: Primeras seis filas de las coordenadas de las variables ambientales
</figcaption>
<div aria-describedby="tbl-tbl8-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NMDS1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NMDS2</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">amb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Wrtrt</td>
<td style="text-align: right;">-0.3127262</td>
<td style="text-align: right;">0.9498433</td>
<td style="text-align: left;">Wrtrt</td>
</tr>
<tr class="even">
<td style="text-align: left;">Artm</td>
<td style="text-align: right;">-0.2306147</td>
<td style="text-align: right;">0.9730451</td>
<td style="text-align: left;">Artm</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Adotsa</td>
<td style="text-align: right;">0.8329060</td>
<td style="text-align: right;">0.5534146</td>
<td style="text-align: left;">Adotsa</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mxmd</td>
<td style="text-align: right;">0.7847086</td>
<td style="text-align: right;">0.6198648</td>
<td style="text-align: left;">Mxmd</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Wotws</td>
<td style="text-align: right;">0.9997759</td>
<td style="text-align: right;">-0.0211676</td>
<td style="text-align: left;">Wotws</td>
</tr>
<tr class="even">
<td style="text-align: left;">Typs</td>
<td style="text-align: right;">0.9974608</td>
<td style="text-align: right;">-0.0712174</td>
<td style="text-align: left;">Typs</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
<section id="figura-de-elipses-por-concavidades---geom_mark_elipse" class="level4">
<h4 class="anchored" data-anchor-id="figura-de-elipses-por-concavidades---geom_mark_elipse"><strong>2.4 Figura de elipses por concavidades - geom_mark_elipse</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>coord.sit,<span class="fu">aes</span>(<span class="at">x=</span>NMDS1, <span class="at">y=</span>NMDS2, </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">colour=</span>grp,<span class="at">fill=</span>grp), <span class="at">alpha=</span><span class="fl">0.2</span>, </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">expand=</span><span class="dv">0</span>, <span class="at">size=</span><span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sitios</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(NMDS1,NMDS2,<span class="at">label=</span><span class="fu">row.names</span>(coord.sit)),</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span>   <span class="co"># Muestra el cuadro de la figura</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(NMDS1,NMDS2,<span class="at">colour=</span>grp),<span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Taxones  *valores de cero para caracteres de las flechas (arrow)</span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> coord.esp,<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> NMDS1, <span class="at">yend =</span> NMDS2), </span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle=</span><span class="dv">0</span>,<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">0</span>,<span class="st">"cm"</span>),</span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),<span class="at">linetype=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">0</span>,<span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.esp,<span class="fu">aes</span>(NMDS1,NMDS2,<span class="at">label=</span>especies),<span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>,<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>))<span class="sc">+</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="estudio-de-caso_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="figura-con-vectores-de-especies-y-variables-ambientales" class="level4">
<h4 class="anchored" data-anchor-id="figura-con-vectores-de-especies-y-variables-ambientales"><strong>2.5 Figura con vectores de especies y variables ambientales</strong></h4>
<p>En la <a href="#fig-fig16" class="quarto-xref">Figura&nbsp;15</a> se puede observar que hay 3 grupos en los que se agruparon las abundancias, donde el grupo 1 y 2 mostraron similitudes entres si, sin embargo, el grupo 3 tuvo considerables diferencias entre los otros grupos. Las variables ambientales que mejor explicaron las abundancias fueron la salinidad, conductividad y TDS. Especies como Hrcl y Mglc no se agruparon con ninguno de los grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Factor</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>coord.sit, <span class="fu">aes</span>(<span class="at">x=</span>NMDS1,<span class="at">y=</span>NMDS2,<span class="at">fill=</span>grp,<span class="at">group=</span>grp,</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">colour=</span>grp),<span class="at">alpha=</span><span class="fl">0.30</span>)  <span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>,<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>))<span class="sc">+</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span><span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sitios</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(NMDS1,NMDS2,<span class="at">label=</span><span class="fu">row.names</span>(coord.sit)),</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span>   <span class="co"># Muestra el cuadro de la figura</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(NMDS1,NMDS2,<span class="at">colour=</span>grp),<span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>)) <span class="sc">+</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Taxones  *valores de cero para caracteres de las flechas (arrow)</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> coord.esp,<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> NMDS1, <span class="at">yend =</span> NMDS2), </span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle=</span><span class="dv">0</span>,<span class="at">length =</span> <span class="fu">unit</span>(<span class="dv">0</span>,<span class="st">"cm"</span>),</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),<span class="at">linetype=</span><span class="dv">0</span>, <span class="at">size=</span><span class="dv">0</span>,<span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.esp,<span class="fu">aes</span>(NMDS1,NMDS2,<span class="at">label=</span>especies),<span class="at">colour =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Ambiental  </span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> coord.amb,<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> NMDS1, <span class="at">yend =</span> NMDS2), </span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle=</span><span class="fl">22.5</span>,<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>,<span class="st">"cm"</span>),</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>                             <span class="at">type =</span> <span class="st">"closed"</span>),<span class="at">linetype=</span><span class="dv">1</span>, <span class="at">size=</span><span class="fl">0.6</span>,<span class="at">colour =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.amb,<span class="fu">aes</span>(NMDS1,NMDS2,<span class="at">label=</span><span class="fu">row.names</span>(coord.amb)),<span class="at">colour =</span> <span class="st">"blue"</span>) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig16" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig16-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig16-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;15: Ordenación de las localidades, los tres grupos, la composición de especies de peces en la cuenca del río Soto La Marina, México y su relación con las variables ambientales.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="análisis-de-clúster-cla" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-clúster-cla">Análisis de clúster (cla)</h2>
<section id="análisis-de-clúster-con-datos-ambientales" class="level3">
<h3 class="anchored" data-anchor-id="análisis-de-clúster-con-datos-ambientales"><strong>Análisis de Clúster con datos ambientales</strong></h3>
</section>
<section id="cargar-la-base-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="cargar-la-base-de-datos">Cargar la base de datos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Base de datos</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>amb_cl <span class="ot">&lt;-</span> d_elipses <span class="sc">%&gt;%</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">39</span>)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Asignar los nombres de los sitios como rownames</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(amb_cl) <span class="ot">&lt;-</span> amb_cl<span class="sc">$</span>Sitios</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="paso-1.-distancia-entre-observaciones" class="level4">
<h4 class="anchored" data-anchor-id="paso-1.-distancia-entre-observaciones"><strong>Paso 1. Distancia entre observaciones</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distancia</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">dist</span>(amb_cl)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># round(d.euclid, 2)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="paso-2.-elección-del-mejor-método-de-agrupación" class="level4">
<h4 class="anchored" data-anchor-id="paso-2.-elección-del-mejor-método-de-agrupación"><strong>Paso 2. Elección del mejor método de agrupación</strong></h4>
<section id="siete-métodos-de-agrupamiento" class="level5">
<h5 class="anchored" data-anchor-id="siete-métodos-de-agrupamiento"><strong>2.1 Siete métodos de agrupamiento</strong></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 1. Vecino más cercano, método "single"</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>Cl.single <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"single"</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 2. Vecino más lejano función "complete"  </span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>Cl.complete<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"complete"</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 3. UPGMA función "average" Unión Promedio no Ponderado</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>Cl.upgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"average"</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 4. UPGMC función "mcquitty" Unión Promedio Ponderado</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>Cl.upgmc<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"mcquitty"</span>)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 5. WPGMA función "centroid"</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>Cl.wpgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"centroid"</span>)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 6. WPGMC función "median"</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>Cl.wpgmc<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"median"</span>)</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 7. WARD, función "ward"</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>Cl.ward<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"ward.D"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
<section id="graficar-los-7-dendogramas" class="level5">
<h5 class="anchored" data-anchor-id="graficar-los-7-dendogramas"><strong>2.2 Graficar los 7 dendogramas</strong></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.single, <span class="at">k =</span> <span class="dv">2</span>,        <span class="co"># k grupos (opcionales)</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,               <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Vecino más Cercano - Single"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.complete, <span class="at">k =</span> <span class="dv">2</span>,        <span class="co"># k grupos (opcionales)</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,               <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Vecino más Lejano - Complete"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuación del código anterior:</span></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.upgma, <span class="at">k =</span> <span class="dv">2</span>,           <span class="co"># k grupos (opcionales)</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,                 <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb58-14"><a href="#cb58-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb58-15"><a href="#cb58-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio no Ponderado - upgma"</span>)  <span class="co"># Título</span></span>
<span id="cb58-16"><a href="#cb58-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.upgmc, <span class="at">k =</span> <span class="dv">2</span>,          </span>
<span id="cb58-18"><a href="#cb58-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,                 </span>
<span id="cb58-19"><a href="#cb58-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  </span>
<span id="cb58-20"><a href="#cb58-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio Ponderado - upgmc"</span>) </span>
<span id="cb58-21"><a href="#cb58-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-22"><a href="#cb58-22" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f1,f2,f3,f4, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig17" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig17-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig17-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;16: Cuatro dendogramas jerárquicos con la distancia euclídea.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>f5 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.wpgma, <span class="at">k =</span> <span class="dv">2</span>,          </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,                 </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Centroide no Ponderado - wpgma"</span>) </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>f6 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.wpgmc, <span class="at">k =</span> <span class="dv">2</span>,          </span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,                 </span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  </span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Centroide Ponderado - wpgmc"</span>) </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>f7 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.ward, <span class="at">k =</span> <span class="dv">2</span>,          </span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,                 </span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  </span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Método de Ward"</span>) </span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f5,f6,f7, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig18" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig18-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig18-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;17: Tres dendogramas jerárquicos restantes, con la distancia euclídea.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="correlación-cofenetica" class="level5">
<h5 class="anchored" data-anchor-id="correlación-cofenetica">2.3. Correlación cofenetica</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Correlación cofenpetica  para "single"</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>cofenet1 <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(Cl.single)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet1)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>simple</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8379654</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) Correlación cofenética  para "complete"</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>cofenet2<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.complete)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>compl <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet2)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>compl</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8888128</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Correlación cofenética  para "average"</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>cofenet3<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.upgma)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>upgma <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet3)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>upgma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9179606</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) CCorrelación cofenética  para "mcquitty"</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>cofenet4<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.upgmc)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>upgmc <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet4)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>upgmc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8890742</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (5) Correlación cofenética  para "centroid"</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>cofenet5<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.wpgma)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>wpgma <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet5)</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>wpgma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9038612</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (6) Correlación cofenética  para "median"</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>cofenet6<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.wpgmc)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>wpgmc <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet6)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>wpgmc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8519392</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (7) Correlación cofenética  para "ward"</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>cofenet7<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.ward)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>ward <span class="ot">=</span> <span class="fu">cor</span>(d.euclid,cofenet7)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>ward</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7582362</code></pre>
</div>
</div>
<p>La <a href="#tbl-tbl9" class="quarto-xref">Tabla&nbsp;9</a> muestra los valores de los cofenéticos, donde se observa que <strong>ugma</strong> (0.918) fue el de mayor valor por lo tanto es el más óptimo para realizar el clúster</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame con cofenéticos</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>cofeneticos <span class="ot">=</span> <span class="fu">data.frame</span>(simple,compl,upgma,upgmc,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                         wpgma,wpgmc,ward)</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cofenéticos por cada métodos (Met)</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>cofenet<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Met =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,<span class="at">Cofen=</span><span class="fu">t</span>(<span class="fu">round</span>(cofeneticos,<span class="dv">3</span>)))</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="co"># tabla con orden descendente de cofenéticos</span></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>cof_ordenado <span class="ot">=</span> cofenet[<span class="fu">order</span>(cofenet<span class="sc">$</span>Cofen, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Impresión de la tabla con los datos</span></span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>cof_ordenado <span class="sc">%&gt;%</span></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl9" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;9: Valores de los cofenéticos para la realización del Cluster.
</figcaption>
<div aria-describedby="tbl-tbl9-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Met</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cofen</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">upgma</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.918</td>
</tr>
<tr class="even">
<td style="text-align: left;">wpgma</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.904</td>
</tr>
<tr class="odd">
<td style="text-align: left;">compl</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.889</td>
</tr>
<tr class="even">
<td style="text-align: left;">upgmc</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.889</td>
</tr>
<tr class="odd">
<td style="text-align: left;">wpgmc</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.852</td>
</tr>
<tr class="even">
<td style="text-align: left;">simple</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.838</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ward</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.758</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
</section>
<section id="paso-3.-número-de-grupos-formados" class="level4">
<h4 class="anchored" data-anchor-id="paso-3.-número-de-grupos-formados"><strong>Paso 3. Número de grupos formados</strong></h4>
<section id="opción-1.-niveles-de-fusión" class="level5">
<h5 class="anchored" data-anchor-id="opción-1.-niveles-de-fusión"><strong>Opción 1. Niveles de Fusión</strong></h5>
<p>En la <a href="#fig-fig19" class="quarto-xref">Figura&nbsp;18</a> muestra que la mayor amplitud se presenta en 2 k cluster, por lo cual, el dendograma se puede clasificar en dos grupos de observaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data.frame con los datos de altura, k y número de cluster</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">h =</span> Cl.upgma<span class="sc">$</span>height, <span class="at">k =</span> <span class="fu">nrow</span>(amb_cl)<span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cluster =</span> <span class="fu">nrow</span>(amb_cl)<span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de dispersión y agregar etiquetas de texto</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(f1, <span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> k, <span class="at">label =</span> cluster)) <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">direction =</span> <span class="st">"vh"</span>) <span class="sc">+</span></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Personalizar el gráfico con títulos, etiquetas de ejes y </span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="co"># paleta de colores</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Niveles de Fusión - Distancia Euclídea - UPGMA"</span>) <span class="sc">+</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"k (Número de Cluster)"</span>) <span class="sc">+</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"h (Altura del Nodo)"</span>) <span class="sc">+</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig19" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig19-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig19-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig19-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;18: Dos regresiones entre la distancia euclídea empleada y las distancias cofenéticas de cada método de agrupamiento definido.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="opción-2.-amplitud-de-silueta-3-insumos-requeridos" class="level5">
<h5 class="anchored" data-anchor-id="opción-2.-amplitud-de-silueta-3-insumos-requeridos"><strong>Opción 2. Amplitud de silueta (3 insumos requeridos)</strong></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Base de datos (amb)</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>amb_cl <span class="ot">&lt;-</span> d_elipses <span class="sc">%&gt;%</span> </span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>   dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">39</span>)</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(amb_cl) <span class="ot">&lt;-</span> amb_cl<span class="sc">$</span>Sitios</span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Distancia utilizada (d.euclid)</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>d.euclid <span class="ot">&lt;-</span> <span class="fu">dist</span>(amb_cl)</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Método de agrupamiento seleccionado (cl.upgma)</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>Cl.upgma<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid,<span class="at">method=</span><span class="st">"average"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Crear un vector vacío (amb.vacio) con asw valores</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>amb.vacio <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(amb_cl))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Silueta "sil" </span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span> (<span class="fu">nrow</span>(amb_cl)<span class="sc">-</span><span class="dv">1</span>)){</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>    sil <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(<span class="fu">cutree</span>(Cl.upgma,<span class="at">k=</span>k),d.euclid)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>    amb.vacio[k]<span class="ot">&lt;-</span><span class="fu">summary</span>(sil)<span class="sc">$</span>avg.width} </span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Mejor o mayor amplitud de silueta (2 particiones)</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>k.mejor <span class="ot">&lt;-</span> <span class="fu">which.max</span>(amb.vacio)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>k.mejor </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2</code></pre>
</div>
</div>
<hr>
<p>La <a href="#fig-fig20" class="quarto-xref">Figura&nbsp;19</a> muestra que el valor máximo de la silueta es alcanzado con 2 clústeres, lo que indica que esta configuración proporciona la mejor separación entre grupos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafica de silueta</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(amb_cl),amb.vacio,<span class="at">type=</span><span class="st">"h"</span>,</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Silueta-Número Óptimo de Clusters"</span>, <span class="at">xlab=</span><span class="st">"(Número de grupos)"</span>,</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Amplitud promedio de  silueta"</span>)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,k.mejor,<span class="fu">paste</span>(<span class="st">"optimum"</span>,k.mejor,<span class="at">sep=</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),<span class="at">col=</span><span class="st">"red"</span>,</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">font=</span><span class="dv">2</span>,<span class="at">col.axis=</span><span class="st">"red"</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(k.mejor,<span class="fu">max</span>(amb.vacio),<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">cex=</span><span class="fl">1.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig20" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig20-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig20-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;19: Determinación del número optimo de clústeres para datos ambientales.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">""</span>,<span class="st">"Silueta-Número óptimo de Clusters k="</span>,k.mejor,</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,<span class="st">"Con una aplitud promedio de silueta"</span>,<span class="fu">max</span>(amb.vacio),<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Silueta-Número óptimo de Clusters k= 2 
 Con una aplitud promedio de silueta 0.5746745 </code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="figura-del-dendograma-jerárquico-final" class="level4">
<h4 class="anchored" data-anchor-id="figura-del-dendograma-jerárquico-final"><strong>Figura del dendograma jerárquico final</strong></h4>
<p>La <a href="#fig-fig21" class="quarto-xref">Figura&nbsp;20</a> La figura nos muestra una clara diferenciación en dos grupos, donde los sitios 42RM, 23P y 43RM son indiscutiblemente un grupo (Color rojo) diferente a los demás sitios (Color azul), donde el grupo rojo podría tener condiciones ambientales únicas, lo que nos sugiere que puede haber dos regiones ambientales. Además, esta separación ocurre a una distancia alta de 1500 más o menos, lo que indica diferencias marcadas entre ambos grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dendograma final </span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(Cl.upgma, <span class="at">k =</span> <span class="dv">2</span>,    <span class="co"># k grupos</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,          <span class="co"># tamaño del texto de las observaciones</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio no Ponderada (UPGMA)"</span>, <span class="co"># Título</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower_rect =</span> <span class="dv">0</span>,         <span class="co"># Inicio de los rectángulos en cero</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_colors =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>,<span class="st">"#FC4E07"</span>),</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">color_labels_by_k =</span> <span class="cn">TRUE</span>,    <span class="co"># Colores para cada grupo</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">rect =</span> <span class="cn">TRUE</span>)                 <span class="co"># Rectángulos de cada grupo</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig21" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig21-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig21-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;20: Agrupamiento jerárquico de sitios en función a las variables ambientales (UPGMA).
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="análisis-de-clúster-con-datos-biológicos" class="level3">
<h3 class="anchored" data-anchor-id="análisis-de-clúster-con-datos-biológicos"><strong>Análisis de Clúster con datos biológicos</strong></h3>
</section>
<section id="cargar-base-de-datos" class="level3">
<h3 class="anchored" data-anchor-id="cargar-base-de-datos">Cargar base de datos</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>biol_cl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"peces marinos méxico_biológicos.xlsx"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(biol_cl) <span class="ot">&lt;-</span> biol_cl<span class="sc">$</span>Sitios</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="paso-1.-distancia-entre-observaciones-1" class="level4">
<h4 class="anchored" data-anchor-id="paso-1.-distancia-entre-observaciones-1"><strong>Paso 1. Distancia entre observaciones</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matriz de distancia</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>d.euclid2 <span class="ot">&lt;-</span> <span class="fu">dist</span>(biol_cl)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co">#  round(d.euclid2, 2)</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="paso-2.-elección-del-mejor-método-de-agrupación-1" class="level4">
<h4 class="anchored" data-anchor-id="paso-2.-elección-del-mejor-método-de-agrupación-1"><strong>Paso 2. Elección del mejor método de agrupación</strong></h4>
<section id="siete-métodos-de-agrupamiento-1" class="level5">
<h5 class="anchored" data-anchor-id="siete-métodos-de-agrupamiento-1"><strong>2.1 Siete métodos de agrupamiento</strong></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 1. Vecino más cercano, método "single"</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>Cl.single2 <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d.euclid2,<span class="at">method=</span><span class="st">"single"</span>)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 2. Vecino más lejano función "complete"  </span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>Cl.complete2 <span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid2,<span class="at">method=</span><span class="st">"complete"</span>)</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 3. UPGMA función "average" Unión Promedio no Ponderado</span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>Cl.upgma2 <span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid2,<span class="at">method=</span><span class="st">"average"</span>)</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 4. UPGMC función "mcquitty" Unión Promedio Ponderado</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>Cl.upgmc2 <span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid2,<span class="at">method=</span><span class="st">"mcquitty"</span>)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 5. WPGMA función "centroid"</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a>Cl.wpgma2 <span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid2,<span class="at">method=</span><span class="st">"centroid"</span>)</span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 6. WPGMC función "median"</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>Cl.wpgmc2 <span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid2,<span class="at">method=</span><span class="st">"median"</span>)</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Método 7. WARD, función "ward"</span></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a>Cl.ward2 <span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid2,<span class="at">method=</span><span class="st">"ward.D"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="graficar-los-7-dendogramas-1" class="level5">
<h5 class="anchored" data-anchor-id="graficar-los-7-dendogramas-1"><strong>2.2 Graficar los 7 dendogramas</strong></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.single2, <span class="at">k =</span> <span class="dv">3</span>,        <span class="co"># k grupos (opcionales)</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,               <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Vecino más Cercano - Single"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.complete2, <span class="at">k =</span> <span class="dv">3</span>,        <span class="co"># k grupos (opcionales)</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,               <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Vecino más Lejano - Complete"</span>)  <span class="co"># Rotulo de título</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Continuación del código anterior:</span></span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.upgma2, <span class="at">k =</span> <span class="dv">3</span>,           <span class="co"># k grupos (opcionales)</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,                 <span class="co"># tamaño del texto de las ramas</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio no Ponderado - upgma"</span>)  <span class="co"># Título</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a>f4 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.upgmc2, <span class="at">k =</span> <span class="dv">3</span>,          </span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,                 </span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  </span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Promedio Ponderado - upgmc"</span>) </span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f1,f2,f3,f4, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig22" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig22-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig22-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig22-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;21: Cuatro dendogramas jerárquicos con la distancia euclídea.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>f5 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.wpgma2, <span class="at">k =</span> <span class="dv">3</span>,          </span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,                 </span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  </span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Centroide no Ponderado - wpgma"</span>) </span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>f6 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.wpgmc2, <span class="at">k =</span> <span class="dv">3</span>,          </span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,                 </span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  </span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión Centroide Ponderado - wpgmc"</span>) </span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>f7 <span class="ot">&lt;-</span> <span class="fu">fviz_dend</span>(Cl.ward2, <span class="at">k =</span> <span class="dv">3</span>,          </span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.6</span>,                 </span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"D.Euclidea"</span>,  </span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Método de Ward"</span>) </span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(f5,f6,f7, <span class="at">ncol =</span> <span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig23" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig23-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig23-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig23-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;22: Tres dendogramas jerárquicos restantes, con la distancia euclídea.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="correlación-cofenética" class="level5">
<h5 class="anchored" data-anchor-id="correlación-cofenética"><strong>2.3 Correlación cofenética</strong></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (1) Correlación cofenpetica  para "single"</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>cofenet1 <span class="ot">&lt;-</span> <span class="fu">cophenetic</span>(Cl.single2)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">=</span> <span class="fu">cor</span>(d.euclid2,cofenet1)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>simple</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8926003</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (2) Correlación cofenética  para "complete"</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>cofenet2<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.complete2)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>compl <span class="ot">=</span> <span class="fu">cor</span>(d.euclid2,cofenet2)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>compl</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8962931</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3) Correlación cofenética  para "average"</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>cofenet3<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.upgma2)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>upgma <span class="ot">=</span> <span class="fu">cor</span>(d.euclid2,cofenet3)</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>upgma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9443006</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (4) CCorrelación cofenética  para "mcquitty"</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>cofenet4<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.upgmc2)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>upgmc <span class="ot">=</span> <span class="fu">cor</span>(d.euclid2,cofenet4)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>upgmc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.94131</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (5) Correlación cofenética  para "centroid"</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>cofenet5<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.wpgma2)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>wpgma <span class="ot">=</span> <span class="fu">cor</span>(d.euclid2,cofenet5)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>wpgma</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9673586</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (6) Correlación cofenética  para "median"</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>cofenet6<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.wpgmc2)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>wpgmc <span class="ot">=</span> <span class="fu">cor</span>(d.euclid2,cofenet6)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>wpgmc</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.927277</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (7) Correlación cofenética  para "ward"</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>cofenet7<span class="ot">&lt;-</span><span class="fu">cophenetic</span>(Cl.ward2)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>ward <span class="ot">=</span> <span class="fu">cor</span>(d.euclid2,cofenet7)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>ward</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.885936</code></pre>
</div>
</div>
<p>La <a href="#tbl-tbl10" class="quarto-xref">Tabla&nbsp;10</a> muestra los valores de los cofenéticos, donde se observa que <strong>wpgma</strong> (0.967) fue el de mayor valor por lo tanto es el más óptimo para realizar el clúster</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data frame con cofenéticos</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>cofeneticos2 <span class="ot">=</span> <span class="fu">data.frame</span>(simple,compl,upgma,upgmc,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>                         wpgma,wpgmc,ward)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="co"># cofenéticos por cada métodos (Met)</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>cofenet<span class="ot">=</span><span class="fu">data.frame</span>(<span class="at">Met =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,<span class="at">Cofen=</span><span class="fu">t</span>(<span class="fu">round</span>(cofeneticos2,<span class="dv">3</span>)))</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="co"># tabla con orden descendente de cofenéticos</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>cof_ordenado <span class="ot">=</span> cofenet[<span class="fu">order</span>(cofenet<span class="sc">$</span>Cofen, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Impresión de la tabla con los datos</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>cof_ordenado <span class="sc">%&gt;%</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(<span class="at">caption =</span> <span class="st">""</span>, <span class="at">booktabs =</span> F,<span class="at">longtable =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> F, <span class="at">html_font =</span> <span class="st">"Cambria"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="tbl-tbl10" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tbl10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Tabla&nbsp;10: Valores de los cofenéticos para la realización del Cluster.
</figcaption>
<div aria-describedby="tbl-tbl10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="lightable-classic do-not-create-environment cell caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Met</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Cofen</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">wpgma</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.967</td>
</tr>
<tr class="even">
<td style="text-align: left;">upgma</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.944</td>
</tr>
<tr class="odd">
<td style="text-align: left;">upgmc</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.941</td>
</tr>
<tr class="even">
<td style="text-align: left;">wpgmc</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0.927</td>
</tr>
<tr class="odd">
<td style="text-align: left;">compl</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.896</td>
</tr>
<tr class="even">
<td style="text-align: left;">simple</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.893</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ward</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.886</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<hr>
</section>
</section>
<section id="paso-3.-número-de-grupos-formados-1" class="level4">
<h4 class="anchored" data-anchor-id="paso-3.-número-de-grupos-formados-1"><strong>Paso 3. Número de grupos formados</strong></h4>
<section id="opción-1.-niveles-de-fusión-1" class="level5">
<h5 class="anchored" data-anchor-id="opción-1.-niveles-de-fusión-1"><strong>Opción 1. Niveles de Fusión</strong></h5>
<p>En la <a href="#fig-fig24" class="quarto-xref">Figura&nbsp;23</a> muestra que la mayor amplitud se presenta en 3 k cluster, por lo cual, el dendograma se puede clasificar en dos grupos de observaciones.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data.frame con los datos de altura, k y número de cluster</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">h =</span> Cl.wpgma2<span class="sc">$</span>height, <span class="at">k =</span> <span class="fu">nrow</span>(biol_cl)<span class="sc">:</span><span class="dv">2</span>, </span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">cluster =</span> <span class="fu">nrow</span>(biol_cl)<span class="sc">:</span><span class="dv">2</span>)</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Crear el gráfico de dispersión y agregar etiquetas de texto</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(f2, <span class="fu">aes</span>(<span class="at">x =</span> h, <span class="at">y =</span> k, <span class="at">label =</span> cluster)) <span class="sc">+</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="at">color =</span> <span class="st">"grey"</span>, <span class="at">direction =</span> <span class="st">"vh"</span>) <span class="sc">+</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Personalizar el gráfico con títulos, etiquetas de ejes y </span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="co"># paleta de colores</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Niveles de Fusión - Distancia Euclídea - WPGMA"</span>) <span class="sc">+</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"k (Número de Cluster)"</span>) <span class="sc">+</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"h (Altura del Nodo)"</span>) <span class="sc">+</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"grey"</span>, <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>)) <span class="sc">+</span></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig24" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig24-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig24-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig24-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;23: Tres regresiones entre la distancia euclídea empleada y las distancias cofenéticas de cada método de agrupamiento definido.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="opción-2.-amplitud-de-silueta-3-insumos-requeridos-1" class="level5">
<h5 class="anchored" data-anchor-id="opción-2.-amplitud-de-silueta-3-insumos-requeridos-1"><strong>Opción 2. Amplitud de silueta (3 insumos requeridos)</strong></h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Base de datos (biol)</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>biol_cl <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"peces marinos méxico_biológicos.xlsx"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(biol_cl) <span class="ot">&lt;-</span> biol_cl<span class="sc">$</span>Sitios</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Distancia utilizada (d.euclid)</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>d.euclid2 <span class="ot">&lt;-</span> <span class="fu">dist</span>(biol_cl)</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Método de agrupamiento seleccionado (cl.wpgma)</span></span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>Cl.wpgma2<span class="ot">&lt;-</span><span class="fu">hclust</span>(d.euclid2,<span class="at">method=</span><span class="st">"average"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Crear un vector vacío (amb.vacio) con asw valores</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>biol.vacio <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">nrow</span>(biol_cl))</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Silueta "sil" </span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span> (<span class="fu">nrow</span>(biol_cl)<span class="sc">-</span><span class="dv">1</span>)){</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>    sil <span class="ot">&lt;-</span> <span class="fu">silhouette</span>(<span class="fu">cutree</span>(Cl.wpgma2,<span class="at">k=</span>k),d.euclid2)</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>    biol.vacio[k]<span class="ot">&lt;-</span><span class="fu">summary</span>(sil)<span class="sc">$</span>avg.width} </span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Mejor o mayor amplitud de silueta (2 particiones)</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>k.mejor <span class="ot">&lt;-</span> <span class="fu">which.max</span>(biol.vacio)</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>k.mejor</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<hr>
<p>La <a href="#fig-fig25" class="quarto-xref">Figura&nbsp;24</a> muestra que el valor máximo de la silueta es alcanzado con 3 clústeres, lo que indica que esta configuración proporciona la mejor separación entre grupos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafica de silueta</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(biol_cl),biol.vacio,<span class="at">type=</span><span class="st">"h"</span>,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Silueta-Número Óptimo de Clusters"</span>, <span class="at">xlab=</span><span class="st">"(Número de grupos)"</span>,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Amplitud promedio de  silueta"</span>)</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>,k.mejor,<span class="fu">paste</span>(<span class="st">"optimum"</span>,k.mejor,<span class="at">sep=</span><span class="st">"</span><span class="sc">\n</span><span class="st">"</span>),<span class="at">col=</span><span class="st">"red"</span>,</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">font=</span><span class="dv">2</span>,<span class="at">col.axis=</span><span class="st">"red"</span>)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(k.mejor,<span class="fu">max</span>(biol.vacio),<span class="at">pch=</span><span class="dv">16</span>,<span class="at">col=</span><span class="st">"red"</span>,<span class="at">cex=</span><span class="fl">1.5</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig25" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig25-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig25-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig25-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;24: Determinación del número optimo de Clústeres para datos biológicos
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">""</span>,<span class="st">"Silueta-Número óptimo de Clusters k="</span>,k.mejor,</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,<span class="st">"Con una aplitud promedio de silueta"</span>,<span class="fu">max</span>(biol.vacio),<span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Silueta-Número óptimo de Clusters k= 3 
 Con una aplitud promedio de silueta 0.7062099 </code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="figura-del-dendograma-jerárquico-final-1" class="level4">
<h4 class="anchored" data-anchor-id="figura-del-dendograma-jerárquico-final-1"><strong>Figura del dendograma jerárquico final</strong></h4>
<p>La <a href="#fig-fig26" class="quarto-xref">Figura&nbsp;25</a> muestra tres grupos principales donde los sitios 35M, 31M y 21P conforman un grupo (color verde) que comparten especies similares que pueden estar asociadas a condiciones ambientales específicas. Luego tenemos un grupo conformado por el sitio 26M (azul) donde podemos apreciar que se distancia significativamente de los demás esto puede ser debido a singularidades del sitio. El resto de sitios (color rojo) presentan una distribución más homogénea, donde es posible considerar una región amplia con gradientes ambientales intermedios.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dendograma final </span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fviz_dend</span>(Cl.wpgma2, <span class="at">k =</span> <span class="dv">3</span>,    <span class="co"># k grupos</span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">cex =</span> <span class="fl">0.7</span>,          <span class="co"># tamaño del texto de las observaciones</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">ylab =</span> <span class="st">"Distancia Euclídea"</span>,  <span class="co"># Rotulo de la distancia</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">main =</span> <span class="st">"Unión centroide no Ponderada (WPGMA)"</span>, <span class="co"># Título</span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">lower_rect =</span> <span class="dv">0</span>,         <span class="co"># Inicio de los rectángulos en cero</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">k_colors =</span> <span class="fu">c</span>(<span class="st">"#00AFBB"</span>,<span class="st">"#FC4E07"</span>,<span class="st">'#2ca25f'</span>),</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">color_labels_by_k =</span> <span class="cn">TRUE</span>,    <span class="co"># Colores para cada grupo</span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">rect =</span> <span class="cn">TRUE</span>)                 <span class="co"># Rectángulos de cada grupo</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig26" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig26-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig26-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig26-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;25: Agrupamiento jerárquico de sitios en función a las variables biológicas (WPGMA)
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="análisis-discriminante-lineal-lda" class="level2">
<h2 class="anchored" data-anchor-id="análisis-discriminante-lineal-lda">Análisis discriminante lineal (lda)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>biol <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"peces marinos méxico_biológicos.xlsx"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>amb <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"peces marinos méxico_ambientales.xlsx"</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>d_elipses <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"datos_PCA.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Hoja2"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>biol_lda <span class="ot">&lt;-</span> d_elipses[, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">40</span><span class="sc">:</span><span class="dv">51</span>)]</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>muestra.entrenamiento <span class="ot">&lt;-</span> </span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>  biol_lda<span class="sc">$</span>Rios <span class="sc">%&gt;%</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">createDataPartition</span>(<span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a>entrenamiento <span class="ot">&lt;-</span> biol_lda[muestra.entrenamiento, ]</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>prueba <span class="ot">&lt;-</span> biol_lda[<span class="sc">-</span>muestra.entrenamiento, ] </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>preprocesamiento <span class="ot">&lt;-</span> </span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  entrenamiento <span class="sc">%&gt;%</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">preProcess</span>(<span class="at">method =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>))</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Transformar los datos usando los parámetros estimados.</span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>entrenam.transf <span class="ot">&lt;-</span> </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>  preprocesamiento <span class="sc">%&gt;%</span> </span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(entrenamiento)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>prueba.transf <span class="ot">&lt;-</span> </span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>  preprocesamiento <span class="sc">%&gt;%</span> </span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(prueba)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. datos de Arroyo grande</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>Arroyo_Grande   <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Rios <span class="sc">==</span> <span class="st">"Arroyo Grande"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Pclm"</span>, <span class="st">"Drsp"</span>, <span class="st">"Nagñ"</span>, <span class="st">"Mxsc"</span>, <span class="st">"Astm"</span>, <span class="st">"Gmbsaf"</span>, <span class="st">"Gmbr"</span>, <span class="st">"Gsp"</span>, <span class="st">"Pclf"</span>, <span class="st">"Msp"</span>, <span class="st">"Aplg"</span>, <span class="st">"Hrcc"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>()</span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. datos de Corona</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a>Corona  <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Rios <span class="sc">==</span> <span class="st">"Corona"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Pclm"</span>, <span class="st">"Drsp"</span>, <span class="st">"Nagñ"</span>, <span class="st">"Mxsc"</span>, <span class="st">"Astm"</span>, <span class="st">"Gmbsaf"</span>, <span class="st">"Gmbr"</span>, <span class="st">"Gsp"</span>, <span class="st">"Pclf"</span>, <span class="st">"Msp"</span>, <span class="st">"Aplg"</span>, <span class="st">"Hrcc"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">as.matrix</span>() </span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. datos de Palmas</span></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a>Palmas <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Rios <span class="sc">==</span> <span class="st">"Palmas"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Pclm"</span>, <span class="st">"Drsp"</span>, <span class="st">"Nagñ"</span>, <span class="st">"Mxsc"</span>, <span class="st">"Astm"</span>, <span class="st">"Gmbsaf"</span>, <span class="st">"Gmbr"</span>, <span class="st">"Gsp"</span>, <span class="st">"Pclf"</span>, <span class="st">"Msp"</span>, <span class="st">"Aplg"</span>, <span class="st">"Hrcc"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>()</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. datos de Pilon</span></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>Pilon <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Rios <span class="sc">==</span> <span class="st">"Pilon"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Pclm"</span>, <span class="st">"Drsp"</span>, <span class="st">"Nagñ"</span>, <span class="st">"Mxsc"</span>, <span class="st">"Astm"</span>, <span class="st">"Gmbsaf"</span>, <span class="st">"Gmbr"</span>, <span class="st">"Gsp"</span>, <span class="st">"Pclf"</span>, <span class="st">"Msp"</span>, <span class="st">"Aplg"</span>, <span class="st">"Hrcc"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>()     </span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. datos de Purificación.</span></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>Purificacion   <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Rios <span class="sc">==</span> <span class="st">"Purificacion"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Pclm"</span>, <span class="st">"Drsp"</span>, <span class="st">"Nagñ"</span>, <span class="st">"Mxsc"</span>, <span class="st">"Astm"</span>, <span class="st">"Gmbsaf"</span>, <span class="st">"Gmbr"</span>, <span class="st">"Gsp"</span>, <span class="st">"Pclf"</span>, <span class="st">"Msp"</span>, <span class="st">"Aplg"</span>, <span class="st">"Hrcc"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>()       </span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. datos de San carlos</span></span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>San_Carlos  <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Rios <span class="sc">==</span> <span class="st">"San Carlos"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Pclm"</span>, <span class="st">"Drsp"</span>, <span class="st">"Nagñ"</span>, <span class="st">"Mxsc"</span>, <span class="st">"Astm"</span>, <span class="st">"Gmbsaf"</span>, <span class="st">"Gmbr"</span>, <span class="st">"Gsp"</span>, <span class="st">"Pclf"</span>, <span class="st">"Msp"</span>, <span class="st">"Aplg"</span>, <span class="st">"Hrcc"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>() </span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. datos de San Felipe</span></span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>San_Marcos  <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Rios <span class="sc">==</span> <span class="st">"San Felipe"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Pclm"</span>, <span class="st">"Drsp"</span>, <span class="st">"Nagñ"</span>, <span class="st">"Mxsc"</span>, <span class="st">"Astm"</span>, <span class="st">"Gmbsaf"</span>, <span class="st">"Gmbr"</span>, <span class="st">"Gsp"</span>, <span class="st">"Pclf"</span>, <span class="st">"Msp"</span>, <span class="st">"Aplg"</span>, <span class="st">"Hrcc"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>() </span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. datos de San marcos</span></span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a>San_Marcos  <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Rios <span class="sc">==</span> <span class="st">"San Marcos"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Pclm"</span>, <span class="st">"Drsp"</span>, <span class="st">"Nagñ"</span>, <span class="st">"Mxsc"</span>, <span class="st">"Astm"</span>, <span class="st">"Gmbsaf"</span>, <span class="st">"Gmbr"</span>, <span class="st">"Gsp"</span>, <span class="st">"Pclf"</span>, <span class="st">"Msp"</span>, <span class="st">"Aplg"</span>, <span class="st">"Hrcc"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>() </span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. datos de Santa Ana.</span></span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a>Santa_Ana  <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Rios <span class="sc">==</span> <span class="st">"Santa Ana"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Pclm"</span>, <span class="st">"Drsp"</span>, <span class="st">"Nagñ"</span>, <span class="st">"Mxsc"</span>, <span class="st">"Astm"</span>, <span class="st">"Gmbsaf"</span>, <span class="st">"Gmbr"</span>, <span class="st">"Gsp"</span>, <span class="st">"Pclf"</span>, <span class="st">"Msp"</span>, <span class="st">"Aplg"</span>, <span class="st">"Hrcc"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>() </span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. datos de Soto la Marina.</span></span>
<span id="cb115-54"><a href="#cb115-54" aria-hidden="true" tabindex="-1"></a>Soto_la_Marina  <span class="ot">&lt;-</span> entrenam.transf <span class="sc">%&gt;%</span> </span>
<span id="cb115-55"><a href="#cb115-55" aria-hidden="true" tabindex="-1"></a>             <span class="fu">filter</span>(Rios <span class="sc">==</span> <span class="st">"Soto la Marina"</span>) <span class="sc">%&gt;%</span>       </span>
<span id="cb115-56"><a href="#cb115-56" aria-hidden="true" tabindex="-1"></a>             <span class="fu">subset</span>(<span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Pclm"</span>, <span class="st">"Drsp"</span>, <span class="st">"Nagñ"</span>, <span class="st">"Mxsc"</span>, <span class="st">"Astm"</span>, <span class="st">"Gmbsaf"</span>, <span class="st">"Gmbr"</span>, <span class="st">"Gsp"</span>, <span class="st">"Pclf"</span>, <span class="st">"Msp"</span>, <span class="st">"Aplg"</span>, <span class="st">"Hrcc"</span>)) <span class="sc">%&gt;%</span>              </span>
<span id="cb115-57"><a href="#cb115-57" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">as.matrix</span>() </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<section id="paso-1.-prueba-de-supuestos" class="level3">
<h3 class="anchored" data-anchor-id="paso-1.-prueba-de-supuestos">Paso 1. Prueba de supuestos</h3>
<section id="supuesto-normalidad" class="level4">
<h4 class="anchored" data-anchor-id="supuesto-normalidad">1.1. Supuesto Normalidad</h4>
<p>Los supuestos de normalidad para la matriz de las variables agrupadores no se lograron obtener debido a que la matriz de estas son singulares, lo cual impide la realización de la prueba.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvnormtest)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co">#norm1 &lt;- mshapiro.test(t(Purificacion))   # Matriz singular</span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co">#norm2   &lt;- mshapiro.test(t(San_Carlos))   # Matriz singular</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co">#norm3 &lt;- mshapiro.test(t(San_Marcos))     # Matriz singular</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="co">#norm4   &lt;- mshapiro.test(t(Santa_Ana))    # Matriz singular</span></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="co">#norm5   &lt;- mshapiro.test(t(Soto_la_Marina))# Matriz singular</span></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co">#norm6   &lt;- mshapiro.test(t(Arroyo_Grande)) # Matriz singular</span></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co">#norm7   &lt;- mshapiro.test(t(Corona))       # Matriz singular</span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="co">#norm8   &lt;- mshapiro.test(t(Pilon))        # Matriz singular</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="supuesto-de-homogeneidad-de-covarianzas" class="level4">
<h4 class="anchored" data-anchor-id="supuesto-de-homogeneidad-de-covarianzas"><strong>1.2 Supuesto de homogeneidad de covarianzas</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="do">### **Supuesto 2. Homogeneidad de covarianzas (esfericidad)**)</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Pruebas de Homogeneidad de covarianzas paquete "vegan"</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>biol.d <span class="ot">&lt;-</span> <span class="fu">dist</span>(entrenam.transf[, <span class="dv">2</span><span class="sc">:</span><span class="dv">13</span>])   <span class="co"># Matriz de distancias</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>biol.homoge <span class="ot">&lt;-</span> <span class="fu">betadisper</span>(biol.d, entrenam.transf<span class="sc">$</span>Rios) <span class="co"># Permutest</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se cumple el supuesto de homogeneidad de covarianzas (F value 0.63; gl 9 y 27; p= 0.75).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Prueba con anova permutacional</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(biol.homoge)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: Distances
          Df  Sum Sq Mean Sq F value Pr(&gt;F)
Groups     9  37.413  4.1571  0.6375 0.7552
Residuals 27 176.059  6.5207               </code></pre>
</div>
</div>
<p>La prueba permutacional, al igual que el anova, nos indican la homogeneidad de covarianza.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Prueba permutacional</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">permutest</span>(biol.homoge)   </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Permutation test for homogeneity of multivariate dispersions
Permutation: free
Number of permutations: 999

Response: Distances
          Df  Sum Sq Mean Sq      F N.Perm Pr(&gt;F)
Groups     9  37.413  4.1571 0.6375    999  0.773
Residuals 27 176.059  6.5207                     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co">#se cumple el supuesto de homogeneidad </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="paso-2.-análisis-discriminante-lineal-de-fisher" class="level3">
<h3 class="anchored" data-anchor-id="paso-2.-análisis-discriminante-lineal-de-fisher"><strong>Paso 2. Análisis discriminante lineal de Fisher</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Modelo Discriminante Lineal (lda)</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>dis<span class="ot">&lt;-</span> <span class="fu">lda</span>(Rios <span class="sc">~</span> Pclm <span class="sc">+</span> Drsp <span class="sc">+</span> Nagñ <span class="sc">+</span> Mxsc <span class="sc">+</span> Astm <span class="sc">+</span> Gmbsaf <span class="sc">+</span> Gmbr <span class="sc">+</span> Gsp <span class="sc">+</span> Pclf <span class="sc">+</span> Msp <span class="sc">+</span> Aplg <span class="sc">+</span> Hrcc, <span class="at">data =</span> entrenam.transf)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(dis<span class="sc">$</span>prior,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Arroyo Grande         Corona         Palmas          Pilon   Purificación 
          0.08           0.11           0.05           0.14           0.16 
    San Carlos     San Felipe     San Marcos      Santa Ana Soto la Marina 
          0.08           0.11           0.08           0.08           0.11 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Grupos de medias para las 10 variables</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(dis<span class="sc">$</span>means,<span class="dv">2</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                Pclm  Drsp  Nagñ  Mxsc  Astm Gmbsaf  Gmbr   Gsp  Pclf   Msp
Arroyo Grande  -0.27 -0.08 -0.36 -0.34  0.78  -0.04 -0.18 -0.25 -0.09 -0.21
Corona         -0.15 -0.17 -0.36 -0.27 -0.29   1.07 -0.18 -0.18 -0.31 -0.16
Palmas         -0.40 -0.17 -0.36 -0.34 -0.61  -0.21 -0.18 -0.23 -0.58 -0.10
Pilon          -0.30  1.04  0.04  0.40 -0.44   0.22 -0.18 -0.25 -0.48 -0.12
Purificación    0.08 -0.17 -0.35 -0.32 -0.28  -0.27 -0.13  0.62  0.90  0.93
San Carlos     -0.23 -0.17 -0.36 -0.34  1.55  -0.18  1.86 -0.25 -0.07 -0.21
San Felipe      0.18 -0.17  0.12  1.36 -0.29  -0.30 -0.18 -0.25 -0.58 -0.21
San Marcos      1.50 -0.17  1.50 -0.34  0.38  -0.30 -0.18 -0.25  0.81 -0.21
Santa Ana       0.12 -0.15  0.86  0.21  0.64  -0.20 -0.09  0.98  0.49 -0.21
Soto la Marina -0.41 -0.17 -0.36 -0.34 -0.66   0.00 -0.18 -0.25 -0.45 -0.21
                Aplg  Hrcc
Arroyo Grande  -0.17  0.66
Corona         -0.17  0.20
Palmas         -0.17 -0.40
Pilon          -0.17 -0.32
Purificación    0.85 -0.27
San Carlos     -0.17  1.07
San Felipe     -0.17  0.02
San Marcos     -0.17 -0.03
Santa Ana      -0.15  0.05
Soto la Marina -0.17 -0.53</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#coordenadas de las vairbles </span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="co"># observaciones en cada eje canónico</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>((Cs <span class="ot">&lt;-</span> dis<span class="sc">$</span>scaling),<span class="dv">2</span>)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         LD1   LD2
Pclm   -0.46 -0.17
Drsp    0.33 -0.08
Nagñ   -0.96 -1.13
Mxsc   -0.56  0.15
Astm   -2.34  0.42
Gmbsaf -0.95  0.31
Gmbr   -2.53  0.51
Gsp    -0.86 -0.88
Pclf    0.66 -1.59
Msp     1.57  0.54
Aplg    0.07  0.62
Hrcc    2.25  0.21</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span> (Cs) <span class="sc">%&gt;%</span> </span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LD1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LD2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LD3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LD4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LD5</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LD6</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LD7</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LD8</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">LD9</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Pclm</td>
<td style="text-align: right;">-0.4611108</td>
<td style="text-align: right;">-0.1670702</td>
<td style="text-align: right;">0.8734557</td>
<td style="text-align: right;">-0.6008359</td>
<td style="text-align: right;">0.4674410</td>
<td style="text-align: right;">-0.0144400</td>
<td style="text-align: right;">0.3273997</td>
<td style="text-align: right;">0.0526857</td>
<td style="text-align: right;">0.4973745</td>
</tr>
<tr class="even">
<td style="text-align: left;">Drsp</td>
<td style="text-align: right;">0.3294878</td>
<td style="text-align: right;">-0.0841283</td>
<td style="text-align: right;">0.1442756</td>
<td style="text-align: right;">0.3950441</td>
<td style="text-align: right;">0.0915713</td>
<td style="text-align: right;">0.6596966</td>
<td style="text-align: right;">-0.6783636</td>
<td style="text-align: right;">0.0860087</td>
<td style="text-align: right;">0.2081170</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nagñ</td>
<td style="text-align: right;">-0.9564251</td>
<td style="text-align: right;">-1.1293095</td>
<td style="text-align: right;">0.1219656</td>
<td style="text-align: right;">-0.0733708</td>
<td style="text-align: right;">0.1262974</td>
<td style="text-align: right;">0.0420176</td>
<td style="text-align: right;">-0.1648399</td>
<td style="text-align: right;">0.1173935</td>
<td style="text-align: right;">0.1520608</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mxsc</td>
<td style="text-align: right;">-0.5586043</td>
<td style="text-align: right;">0.1515974</td>
<td style="text-align: right;">0.0138417</td>
<td style="text-align: right;">1.1481741</td>
<td style="text-align: right;">0.1888754</td>
<td style="text-align: right;">-0.1983598</td>
<td style="text-align: right;">0.3781831</td>
<td style="text-align: right;">0.3116321</td>
<td style="text-align: right;">-0.4263003</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Astm</td>
<td style="text-align: right;">-2.3424174</td>
<td style="text-align: right;">0.4179283</td>
<td style="text-align: right;">-0.3268692</td>
<td style="text-align: right;">0.1142469</td>
<td style="text-align: right;">0.0050129</td>
<td style="text-align: right;">0.1172698</td>
<td style="text-align: right;">0.0091921</td>
<td style="text-align: right;">0.2031839</td>
<td style="text-align: right;">-0.3302658</td>
</tr>
<tr class="even">
<td style="text-align: left;">Gmbsaf</td>
<td style="text-align: right;">-0.9493697</td>
<td style="text-align: right;">0.3087259</td>
<td style="text-align: right;">0.1341840</td>
<td style="text-align: right;">-0.1095706</td>
<td style="text-align: right;">0.1222909</td>
<td style="text-align: right;">-0.9691436</td>
<td style="text-align: right;">-0.0515517</td>
<td style="text-align: right;">0.7045858</td>
<td style="text-align: right;">-0.2386047</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas de las seis primeras </span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="co"># observaciones en cada eje canónico</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">head</span>(Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x),<span class="dv">2</span>)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    LD1   LD2
1  1.28  0.86
2  1.39  0.79
3 -0.09  1.02
4  0.98  1.08
5 -1.83 -0.18
6 -2.41 -2.83</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Evaluación de desempeño del AD (método 1)</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(entrenam.transf)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>(tabla<span class="ot">&lt;-</span><span class="fu">table</span>(Rios,group))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                group
Rios             Arroyo Grande Corona Palmas Pilon Purificación San Carlos
  Arroyo Grande              1      0      0     0            0          0
  Corona                     0      1      0     0            0          0
  Palmas                     0      0      0     0            0          0
  Pilon                      0      0      0     1            0          0
  Purificación               0      0      0     0            4          0
  San Carlos                 0      0      0     0            0          3
  San Felipe                 0      0      0     0            0          0
  San Marcos                 0      0      0     1            0          0
  Santa Ana                  0      0      0     0            0          0
  Soto la Marina             0      0      0     0            0          0
                group
Rios             San Felipe San Marcos Santa Ana Soto la Marina
  Arroyo Grande           0          0         0              2
  Corona                  0          0         0              3
  Palmas                  0          0         0              2
  Pilon                   1          0         0              3
  Purificación            0          0         0              2
  San Carlos              0          0         0              0
  San Felipe              2          0         0              2
  San Marcos              0          2         0              0
  Santa Ana               0          1         2              0
  Soto la Marina          0          0         0              4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>tabla <span class="sc">%&gt;%</span> </span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width=</span>F)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Arroyo Grande</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Corona</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Palmas</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pilon</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Purificación</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">San Carlos</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">San Felipe</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">San Marcos</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Santa Ana</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Soto la Marina</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Arroyo Grande</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Corona</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Palmas</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pilon</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Purificación</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">San Carlos</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">San Felipe</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">San Marcos</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Santa Ana</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Soto la Marina</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Porcentaje de clasificación correcta </span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">diag</span>(<span class="fu">prop.table</span>(tabla, <span class="dv">1</span>)),<span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Arroyo Grande         Corona         Palmas          Pilon   Purificación 
            33             25              0             20             67 
    San Carlos     San Felipe     San Marcos      Santa Ana Soto la Marina 
           100             50             67             67            100 </code></pre>
</div>
</div>
</section>
<section id="paso-3.-visualización-grafica-del-lda" class="level3">
<h3 class="anchored" data-anchor-id="paso-3.-visualización-grafica-del-lda"><strong>Paso 3. Visualización grafica del LDA</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcular la tabla de proporciones por fila</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>tabla_prop <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tabla, <span class="dv">1</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar el porcentaje de clasificación correcta por clase</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">diag</span>(tabla_prop), <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Arroyo Grande         Corona         Palmas          Pilon   Purificación 
            33             25              0             20             67 
    San Carlos     San Felipe     San Marcos      Santa Ana Soto la Marina 
           100             50             67             67            100 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Redondear toda la tabla a dos decimales y mostrarla con formato</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(tabla_prop, <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>() <span class="sc">%&gt;%</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_classic</span>(<span class="at">full_width =</span> <span class="cn">FALSE</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="lightable-classic caption-top table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Arroyo Grande</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Corona</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Palmas</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pilon</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Purificación</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">San Carlos</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">San Felipe</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">San Marcos</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Santa Ana</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Soto la Marina</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Arroyo Grande</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.67</td>
</tr>
<tr class="even">
<td style="text-align: left;">Corona</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.25</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.75</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Palmas</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pilon</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.20</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.2</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Purificación</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.33</td>
</tr>
<tr class="even">
<td style="text-align: left;">San Carlos</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">San Felipe</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.5</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.50</td>
</tr>
<tr class="even">
<td style="text-align: left;">San Marcos</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Santa Ana</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.33</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;">0.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Soto la Marina</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Coordenadas de los sitios y el factor (coord.sit)</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Coordenadas de los sitios</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>Fp <span class="ot">&lt;-</span> <span class="fu">predict</span>(dis)<span class="sc">$</span>x</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Grupos </span></span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">predict</span>(dis,<span class="at">method=</span><span class="st">"plug-in"</span>)<span class="sc">$</span>class</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Dataframe</span></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>coord.sit <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(dis)<span class="sc">$</span>x[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])     <span class="co"># Coordenadas de los sitios</span></span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>coord.sit<span class="sc">$</span>sitio <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.sit)               <span class="co"># Crear una columna con nombres de los sitios</span></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>coord.sit<span class="sc">$</span>grp <span class="ot">&lt;-</span> group                               <span class="co"># Adicionar columna de grupos por Tributario</span></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coord.sit)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         LD1        LD2 sitio            grp
1  1.2819949  0.8618685     1 Soto la Marina
2  1.3890654  0.7854858     2 Soto la Marina
3 -0.0886757  1.0220521     3 Soto la Marina
4  0.9849785  1.0849283     4     San Felipe
5 -1.8307209 -0.1763901     5     San Felipe
6 -2.4105921 -2.8335702     6     San Marcos</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Coordenadasde las variables (coord.var) </span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>coord.var <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">round</span>((Cs <span class="ot">&lt;-</span> dis<span class="sc">$</span>scaling),<span class="dv">2</span>)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])    <span class="co"># Dos primeros ejes</span></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">rownames</span>(coord.var)</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>coord.var <span class="ot">&lt;-</span> <span class="fu">cbind</span>(coord.var, <span class="at">variables =</span> variables)</span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(coord.var)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         LD1   LD2 variables
Pclm   -0.46 -0.17      Pclm
Drsp    0.33 -0.08      Drsp
Nagñ   -0.96 -1.13      Nagñ
Mxsc   -0.56  0.15      Mxsc
Astm   -2.34  0.42      Astm
Gmbsaf -0.95  0.31    Gmbsaf</code></pre>
</div>
</div>
<hr>
<section id="figura-con-vectores-de-variables-biológicas" class="level4">
<h4 class="anchored" data-anchor-id="figura-con-vectores-de-variables-biológicas">Figura con vectores de variables biológicas</h4>
<p>La <a href="#fig-fig27" class="quarto-xref">Figura&nbsp;26</a> muestra cómo se separan los ríos según las abundancias de peces presentes en cada uno. Se observaron ríos que se separaron del resto, como San Carlos y Purificación. Los ríos San Marcos y Santa Ana mostraron similitudes en las abundancias de peces. Además, los ríos Soto la Marina, San Felipe, Pilón, Arroyo Grande y Corona se solaparon, lo que indica una similitud considerable en las abundancias. Por último, los ríos Purificación y San Carlos se mostraron distantes, lo que sugiere mayores diferencias&nbsp;entre&nbsp;ellos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Figura con vectores de variables biológicas</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Sitios</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(LD1,LD2,<span class="at">label=</span><span class="fu">row.names</span>(coord.sit)),</span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span>   <span class="co"># Muestra el cuadro de la figura</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> coord.sit,<span class="fu">aes</span>(LD1,LD2,<span class="at">colour=</span>grp),<span class="at">size=</span><span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">21</span><span class="sc">:</span><span class="dv">25</span>))<span class="sc">+</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Variables biológicas  </span></span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> coord.var,<span class="fu">aes</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> LD1<span class="sc">*</span><span class="dv">2</span>, <span class="at">yend =</span> LD2<span class="sc">*</span><span class="dv">2</span>), </span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">angle=</span><span class="fl">22.5</span>,<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.25</span>,<span class="st">"cm"</span>),</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">type =</span> <span class="st">"closed"</span>),<span class="at">linetype=</span><span class="dv">1</span>, <span class="at">size=</span><span class="fl">0.6</span>,<span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="at">data =</span> coord.var,<span class="fu">aes</span>(LD1<span class="sc">*</span><span class="dv">2</span>,LD2<span class="sc">*</span><span class="dv">2</span>,<span class="at">label=</span>variables),<span class="at">colour =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Grupos</span></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_mark_ellipse</span>(<span class="at">data=</span>coord.sit,<span class="fu">aes</span>(<span class="at">x=</span>LD1,<span class="at">y=</span>LD2,<span class="at">fill=</span>grp),<span class="at">alpha=</span><span class="fl">0.30</span>) <span class="sc">+</span></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">0</span>,<span class="at">linetype=</span><span class="dv">3</span>,<span class="at">size=</span><span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">shape=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>,<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>         <span class="at">fill=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="cn">NULL</span>))<span class="sc">+</span></span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid=</span><span class="fu">element_blank</span>())</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig27" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig27-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig27-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig27-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;26: Análisis Discriminante Lineal (LDA) basado en variables biológicas de peces agrupados por ríos.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="análisis-discriminante-canónico-dca" class="level2">
<h2 class="anchored" data-anchor-id="análisis-discriminante-canónico-dca">Análisis discriminante canónico (dca)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>entrenam.transf<span class="sc">$</span>Rios <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(entrenam.transf<span class="sc">$</span>Rios)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(entrenam.transf<span class="sc">$</span>Rios) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"AG"</span>,<span class="st">"Cona"</span>, <span class="st">"Pmas"</span>, <span class="st">"Plon"</span>, <span class="st">"Pcion"</span>, <span class="st">"Slos"</span>,<span class="st">"Slipe"</span>, <span class="st">"Scos"</span>, <span class="st">"SAna"</span> ,<span class="st">"Srina"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(entrenam.transf<span class="sc">$</span>Rios)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "AG"    "Cona"  "Pmas"  "Plon"  "Pcion" "Slos"  "Slipe" "Scos"  "SAna" 
[10] "Srina"</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(entrenam.transf)</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(entrenam.transf)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Rios"   "Pclm"   "Drsp"   "Nagñ"   "Mxsc"   "Astm"   "Gmbsaf" "Gmbr"  
 [9] "Gsp"    "Pclf"   "Msp"    "Aplg"   "Hrcc"  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelo Lineal multivariado</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>mod <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">cbind</span>(Pclm, Drsp, Nagñ, Mxsc, Astm, Gmbsaf, Gmbr, Gsp, Pclf, Msp, Aplg, Hrcc) <span class="sc">~</span> Rios,entrenam.transf)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Análisis discriminante canónico - ADC</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(candisc)</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>can <span class="ot">&lt;-</span> <span class="fu">candisc</span>(mod, <span class="at">term=</span> <span class="st">"Rios"</span>,<span class="at">data=</span>entrenam.transf,<span class="at">ndim=</span><span class="dv">1</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
<p>La <a href="#fig-fig28" class="quarto-xref">Figura&nbsp;27</a> muestra el primer eje canónico (Can1), que explica el 52.9% de la variación entre los grupos, que nos muestra una clara diferenciación de los Ríos, como por ejemplo en San Carlos (Slos), San Marcos (Scos) y San Felipe (Slipe) que se separan notablemente del resto de ríos (ubicados en la parte superior), donde las especies de peces que más influyeron en la caracterización fueron Astm, Gmbr seguido de Hrcc. Por otro lado en el panel inferior los ríos están asociados a especies de peces con contribuciones bajas. Además de esto, podemos apreciar solapamiento entre los ríos Palmas (Pmas) y Pilón (Plon), esto nos dice que estas comunidades no son tan distintas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(can,<span class="at">titles.1d =</span> <span class="fu">c</span>(<span class="st">"Puntuación canónica"</span>, <span class="st">"Estructura"</span>), <span class="at">cex.main =</span> <span class="fl">1.6</span>,    <span class="co"># Títulos grandes</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.4</span>,     <span class="co"># Etiquetas de ejes</span></span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.axis =</span> <span class="fl">1.1</span>)    <span class="co"># Texto del eje X e Y </span></span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-fig28" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fig28-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="estudio-de-caso_files/figure-html/fig-fig28-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fig28-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;27: Distribución de los peces en las dististas cuencas del Río Soto La Marina.
</figcaption>
</figure>
</div>
</div>
</div>
<hr>
</section>
<section id="referencias-bibliográficas" class="level2">
<h2 class="anchored" data-anchor-id="referencias-bibliográficas">Referencias bibliográficas</h2>
<ol type="1">
<li><p>De Catalunya, U. O., Ventura, C., &amp; Fernando, C. B. (2018). <em>Empleo de modelos estadísticos multivariantes para el análisis de comportamiento de comunidades ecológicas</em>. <a href="http://hdl.handle.net/10609/72629" class="uri">http://hdl.handle.net/10609/72629</a></p></li>
<li><p>González, A.R. (2017). Ecología aplicada: diseño y análisis estadístico.</p></li>
<li><p>Ospina, J.S., López-Delgado, E.O., &amp; Villa-Navarro, F.A. (2023). Estructura y diversidad de las comunidades ícticas a lo largo de un gradiente longitudinal en ríos costeros de la Sierra Nevada de Santa Marta.&nbsp;<em>Revista de la Academia Colombiana de Ciencias Exactas, Físicas y Naturales</em>.</p></li>
<li><p>Torrruco, D., González, A., &amp; González, Á. T. (2017). Diversidad y distribución de peces y su relación con variables ambientales, en el sur del Golfo de México.&nbsp;<em>Revista de Biología Tropical</em>,&nbsp;<em>66</em>(1), 438.&nbsp;https://doi.org/10.15517/rbt.v66i1.26255</p></li>
</ol>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>